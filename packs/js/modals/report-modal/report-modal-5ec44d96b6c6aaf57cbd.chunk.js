"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[219],{1416:function(e,t,r){r.r(t),r.d(t,{default:function(){return K}});var a,s=r(2044),o=r(2054),n=r(1),i=r(2055),d=r(2056),c=r(2074),u=r(46),l=r(196),f=r(79),g=r(532),m=r(98),p=r(327),v=r(2),h=r(80),Z=r(3),b=r(179),k=(0,i.vU)({title:{id:"report.confirmation.title",defaultMessage:"Thanks for submitting your report."},content:{id:"report.confirmation.content",defaultMessage:"If we find that this account is violating the {link} we will take further action on the matter."}}),y=(0,o.Z)(c.Z,{id:"shared.tos",defaultMessage:"Terms of Service"}),M=(r(5),r(914)),w=r(496),x=r(805),C=(r(28),r(33),r(0),r(13),r(29),r(861)),E=r.n(C),T=r(530),_=r(82),N=function(e){var t,r,a,s=e.id,n=e.disabled,i=(0,Z.TL)(),d=(0,Z.CG)((function(e){return e.statuses.get(s)})),c=(0,Z.CG)((function(e){return e.reports.new.status_ids.includes(s)}));if(!d||d.reblog)return null;if(d.media_attachments.size>0)if(d.media_attachments.some((function(e){return"unknown"===e.type})));else if("video"===(null===(r=d.media_attachments.get(0))||void 0===r?void 0:r.type)){var u=d.media_attachments.get(0);u&&(t=(0,o.Z)(T.Z,{fetchComponent:_.nk},void 0,(function(e){return(0,o.Z)(e,{preview:u.preview_url,blurhash:u.blurhash,src:u.url,alt:u.description,aspectRatio:u.meta.getIn(["original","aspect"]),width:239,height:110,inline:!0,sensitive:d.sensitive,onOpenVideo:E()})})))}else if("audio"===(null===(a=d.media_attachments.get(0))||void 0===a?void 0:a.type)){var f=d.media_attachments.get(0);f&&(t=(0,o.Z)(T.Z,{fetchComponent:_.Bb},void 0,(function(e){return(0,o.Z)(e,{src:f.url,alt:f.description,inline:!0,sensitive:d.sensitive,onOpenAudio:E()})})))}else t=(0,o.Z)(T.Z,{fetchComponent:_.ew},void 0,(function(e){return(0,o.Z)(e,{media:d.media_attachments,sensitive:d.sensitive,height:110,onOpenMedia:E()})}));return(0,o.Z)("div",{className:"status-check-box"},void 0,(0,o.Z)("div",{className:"status-check-box__status"},void 0,(0,o.Z)(p.Z,{status:d}),t),(0,o.Z)("div",{className:"status-check-box-toggle"},void 0,(0,o.Z)(w.Z,{checked:c,onChange:function(e){return i((0,l.cm)(s,e.target.checked))},disabled:n,icons:!1})))},S=r(131),A=(0,i.vU)({addAdditionalStatuses:{id:"report.otherActions.addAdditional",defaultMessage:"Would you like to add additional statuses to this report?"},addMore:{id:"report.otherActions.addMore",defaultMessage:"Add more"},furtherActions:{id:"report.otherActions.furtherActions",defaultMessage:"Further actions:"},hideAdditonalStatuses:{id:"report.otherActions.hideAdditional",defaultMessage:"Hide additional statuses"},otherStatuses:{id:"report.otherActions.otherStatuses",defaultMessage:"Include other statuses?"}}),O=(r(10),r(653)),z=(0,i.vU)({placeholder:{id:"report.placeholder",defaultMessage:"Additional comments"},reasonForReporting:{id:"report.reason.title",defaultMessage:"Reason for reporting"}}),G=(0,i.vU)({blankslate:{id:"report.reason.blankslate",defaultMessage:"You have removed all statuses from being selected."},done:{id:"report.done",defaultMessage:"Done"},next:{id:"report.next",defaultMessage:"Next"},submit:{id:"report.submit",defaultMessage:"Submit"},reportContext:{id:"report.chatMessage.context",defaultMessage:"When reporting a userâ€™s message, the five messages before and five messages after the one selected will be passed along to our moderation team for context."},reportMessage:{id:"report.chatMessage.title",defaultMessage:"Report message"},cancel:{id:"common.cancel",defaultMessage:"Cancel"},previous:{id:"report.previous",defaultMessage:"Previous"}});!function(e){e.ONE="ONE",e.TWO="TWO",e.THREE="THREE"}(a||(a={}));var H,R={ONE:function(e){var t=(0,Z.TL)(),r=(0,d.Z)(),a=(0,n.useRef)(null),i=(0,n.useState)(!1),c=(0,s.Z)(i,2),u=c[0],f=c[1],g=(0,n.useState)(!0),m=(0,s.Z)(g,2),p=m[0],h=m[1],b=(0,Z.CG)((function(e){return e.reports.new.comment})),k=(0,Z.CG)((function(e){return e.rules.items})),y=(0,Z.CG)((function(e){return e.reports.new.rule_ids})),M=k.length>0,w=(0,Z.CG)((function(e){return e.reports.new.status_ids})),C=(0,n.useMemo)((function(){return 0===w.size}),[]);return(0,n.useEffect)((function(){t((0,x.j)())}),[]),(0,n.useEffect)((function(){k.length>0&&a.current&&a.current.clientHeight<=385&&f(!0)}),[k,a.current]),(0,o.Z)(v.Kq,{space:4},void 0,M&&(0,o.Z)(v.Kq,{space:2},void 0,(0,o.Z)(v.xv,{size:"xl",weight:"semibold",tag:"h1"},void 0,r.formatMessage(z.reasonForReporting)),(0,o.Z)("div",{className:"relative"},void 0,n.createElement("div",{style:{maxHeight:385},className:"-space-y-px overflow-y-auto rounded-lg",onScroll:function(){if(a.current){var e=a.current,t=e.scrollTop,r=e.scrollHeight,s=e.clientHeight;f(t+s>r-24),h(t<24)}},ref:a},k.filter((function(e){var t=C?"account":"content";return!e.rule_type||e.rule_type===t})).map((function(e,r){var a=y.includes(String(e.id));return(0,o.Z)("button",{"data-testid":"rule-".concat(e.id),onClick:function(){return t((0,l.Nr)(e.id))},className:(0,O.default)({"relative border border-solid border-gray-200 dark:border-gray-800 hover:bg-gray-100 dark:hover:bg-primary-800/30 text-start w-full p-4 flex justify-between items-center cursor-pointer":!0,"rounded-tl-lg rounded-tr-lg":0===r,"rounded-bl-lg rounded-br-lg":r===k.length-1,"bg-gray-200 hover:bg-gray-200 dark:bg-primary-800/50":a})},r,(0,o.Z)(v.Kq,{className:"mr-3"},void 0,(0,o.Z)(v.xv,{tag:"span",size:"sm",weight:"medium",theme:a?"primary":"default"},void 0,e.text),(0,o.Z)(v.xv,{tag:"span",theme:"muted",size:"sm"},void 0,e.subtext)),(0,o.Z)("input",{name:"reason",type:"checkbox",value:e.id,checked:a,readOnly:!0,className:"h-4 w-4 rounded border-2 border-gray-300 text-primary-600 checked:bg-primary-500 focus:ring-primary-500 dark:border-gray-800 dark:bg-gray-900 dark:checked:bg-primary-500 dark:focus:ring-primary-500"}))}))),(0,o.Z)("div",{className:(0,O.default)("pointer-events-none absolute inset-x-0 top-0 flex justify-center rounded-t-lg bg-gradient-to-b from-white pb-12 pt-8 transition-opacity duration-500 dark:from-gray-900",{"opacity-0":p,"opacity-100":!p})}),(0,o.Z)("div",{className:(0,O.default)("pointer-events-none absolute inset-x-0 bottom-0 flex justify-center rounded-b-lg bg-gradient-to-t from-white pt-12 pb-8 transition-opacity duration-500 dark:from-gray-900",{"opacity-0":u,"opacity-100":!u})}))),(0,o.Z)(v.cw,{labelText:r.formatMessage(z.placeholder)},void 0,(0,o.Z)(v.gx,{placeholder:r.formatMessage(z.placeholder),value:b,onChange:function(e){t((0,l.Ck)(e.target.value))}})))},TWO:function(e){var t=e.account,a=(0,Z.TL)(),i=(0,Z.hz)(),u=(0,d.Z)(),f=(0,Z.CG)((function(e){return(0,M.OrderedSet)(e.timelines.get("account:".concat(t.id,":with_replies")).items).union(e.reports.new.status_ids)})),g=(0,Z.CG)((function(e){return e.reports.new.block})),m=(0,Z.CG)((function(e){return e.reports.new.forward})),p=(0,S.Q1)(t)&&i.federating,h=(0,Z.CG)((function(e){return e.reports.new.isSubmitting})),b=(0,n.useState)(!1),k=(0,s.Z)(b,2),y=k[0],C=k[1];return(0,n.useEffect)((function(){a((0,x.j)())}),[]),(0,o.Z)(v.Kq,{space:4},void 0,i.reportMultipleStatuses&&(0,o.Z)(v.Kq,{space:2},void 0,(0,o.Z)(v.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,u.formatMessage(A.otherStatuses)),(0,o.Z)(v.cw,{labelText:u.formatMessage(A.addAdditionalStatuses)},void 0,y?(0,o.Z)(v.Kq,{space:2},void 0,(0,o.Z)("div",{className:"divide-y divide-solid divide-gray-200 dark:divide-gray-800"},void 0,f.map((function(e){return(0,o.Z)(N,{id:e},e)}))),(0,o.Z)("div",{},void 0,(0,o.Z)(v.zx,{icon:r(1272),theme:"tertiary",size:"sm",onClick:function(){return C(!1)}},void 0,u.formatMessage(A.hideAdditonalStatuses)))):(0,o.Z)(v.zx,{icon:r(164),theme:"tertiary",size:"sm",onClick:function(){return C(!0)}},void 0,u.formatMessage(A.addMore)))),(0,o.Z)(v.Kq,{space:2},void 0,(0,o.Z)(v.xv,{tag:"h1",size:"xl",weight:"semibold"},void 0,u.formatMessage(A.furtherActions)),(0,o.Z)(v.cw,{labelText:(0,o.Z)(c.Z,{id:"report.block_hint",defaultMessage:"Do you also want to block this account?"})},void 0,(0,o.Z)(v.Ug,{space:2,alignItems:"center"},void 0,(0,o.Z)(w.Z,{checked:g,onChange:function(e){a((0,l.LG)(e.target.checked))},icons:!1,id:"report-block"}),(0,o.Z)(v.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-block"},void 0,(0,o.Z)(c.Z,{id:"report.block",defaultMessage:"Block {target}",values:{target:"@".concat(t.get("acct"))}})))),p&&(0,o.Z)(v.cw,{labelText:(0,o.Z)(c.Z,{id:"report.forward_hint",defaultMessage:"The account is from another server. Send a copy of the report there as well?"})},void 0,(0,o.Z)(v.Ug,{space:2,alignItems:"center"},void 0,(0,o.Z)(w.Z,{checked:m,onChange:function(e){a((0,l.$p)(e.target.checked))},icons:!1,id:"report-forward",disabled:h}),(0,o.Z)(v.xv,{theme:"muted",tag:"label",size:"sm",htmlFor:"report-forward"},void 0,(0,o.Z)(c.Z,{id:"report.forward",defaultMessage:"Forward to {target}",values:{target:(0,S.ge)(t)}}))))))},THREE:function(e){e.account;var t,r=(0,d.Z)(),a=(0,Z.CG)((function(e){return(0,b.UX)(e).get("links")}));return(0,o.Z)(v.Kq,{space:1},void 0,(0,o.Z)(v.xv,{weight:"semibold",tag:"h1",size:"xl"},void 0,r.formatMessage(k.title)),(0,o.Z)(v.xv,{},void 0,r.formatMessage(k.content,{link:a.get("termsOfService")?(t=a.get("termsOfService"),(0,o.Z)("a",{href:t,target:"_blank",className:"text-primary-600 hover:text-primary-800 hover:underline dark:text-accent-blue dark:hover:text-accent-blue"},void 0,y)):y})))}},q=function(e){var t=e.statusId,r=(0,Z.CG)((function(e){return e.statuses.get(t)}));return r?(0,o.Z)(v.Kq,{space:2,className:"rounded-lg bg-gray-100 p-4 dark:bg-gray-800"},void 0,(0,o.Z)(h.Z,{id:r.account,showProfileHoverCard:!1,withLinkToProfile:!1,timestamp:r.created_at,hideActions:!0}),(0,o.Z)(p.Z,{status:r,collapsable:!0}),r.media_attachments.size>0&&(0,o.Z)(g.Z,{media:r.media_attachments,sensitive:r.sensitive})):null};!function(e){e.Account="Account",e.Status="Status",e.ChatMessage="ChatMessage"}(H||(H={}));var K=function(e){var t=e.onClose,i=(0,Z.TL)(),g=(0,d.Z)(),p=(0,Z.CG)((function(e){return e.reports.new.account_id})),h=(0,Z.mA)(p),b=(0,Z.CG)((function(e){return e.reports.new.block})),k=(0,Z.CG)((function(e){return e.reports.new.isSubmitting})),y=(0,Z.CG)((function(e){return e.rules.items})),M=(0,Z.CG)((function(e){return e.reports.new.rule_ids})),w=(0,Z.CG)((function(e){return e.reports.new.status_ids})),x=(0,Z.CG)((function(e){return e.reports.new.chat_message})),C=y.length>0,E=(0,n.useMemo)((function(){return 0!==w.size||x?x?H.ChatMessage:H.Status:H.Account}),[]),T=E===H.Account,_=E===H.Status,N=(0,n.useState)(a.ONE),S=(0,s.Z)(N,2),A=S[0],O=S[1],z=(0,n.useCallback)((function(){return 0===w.size?(0,o.Z)("div",{className:"flex w-full items-center justify-center rounded-lg bg-gray-100 p-4 dark:bg-gray-800"},void 0,(0,o.Z)(v.xv,{theme:"muted"},void 0,g.formatMessage(G.blankslate))):(0,o.Z)(q,{statusId:w.first()})}),[w.size]),K=(0,n.useMemo)((function(){return A===a.ONE?g.formatMessage(G.cancel):g.formatMessage(G.previous)}),[A]),I=(0,n.useMemo)((function(){switch(A){case a.TWO:return g.formatMessage(G.submit);case a.THREE:return g.formatMessage(G.done);default:return g.formatMessage(G.next)}}),[A]),W=(0,n.useMemo)((function(){return A!==a.THREE&&(k||C&&M.isEmpty()||_&&0===w.size)}),[A,k,C,M,w.size,_]),U=(0,n.useCallback)((function(){switch(A){case a.ONE:return.33;case a.TWO:return.66;case a.THREE:return 1;default:return 0}}),[A]);if((0,n.useEffect)((function(){h&&i((0,f.Cn)(h.id,{withReplies:!0,maxId:null}))}),[h]),!h)return null;var F=R[A];return(0,o.Z)(v.u_,{title:E===H.ChatMessage?g.formatMessage(G.reportMessage):(0,o.Z)(c.Z,{id:"report.target",defaultMessage:"Reporting {target}",values:{target:(0,o.Z)("strong",{},void 0,"@",null==h?void 0:h.acct)}}),onClose:t,cancelText:K,cancelAction:A===a.THREE?void 0:function(){switch(A){case a.ONE:t();break;case a.TWO:O(a.ONE)}},confirmationAction:function(){switch(A){case a.ONE:O(a.TWO);break;case a.TWO:i((0,l.ZD)()).then((function(){return O(a.THREE)})).catch((function(e){return i((0,l.rC)(e))})),b&&h&&i((0,u.Gy_)(h.id));break;case a.THREE:i((0,l.rq)()),t()}},confirmationText:I,confirmationDisabled:W,skipFocus:!0},void 0,(0,o.Z)(v.Kq,{space:4},void 0,(0,o.Z)(v.ko,{progress:U()}),A!==a.THREE&&!T&&function(){switch(E){case H.Status:return z();case H.ChatMessage:return function(){if(h)return(0,o.Z)(v.Kq,{space:4},void 0,(0,o.Z)(v.Ug,{alignItems:"center",space:4,className:"rounded-md border border-solid border-gray-400 p-4 dark:border-2 dark:border-gray-800"},void 0,(0,o.Z)("div",{},void 0,(0,o.Z)(v.qE,{src:h.avatar,className:"h-8 w-8"})),(0,o.Z)("div",{className:"grow rounded-md bg-gray-200 p-4 dark:bg-primary-800"},void 0,(0,o.Z)(v.xv,{dangerouslySetInnerHTML:{__html:null==x?void 0:x.content}}))),(0,o.Z)(m.Z,{},void 0,(0,o.Z)(m.H,{label:(0,o.Z)(v.JO,{src:r(529),className:"text-gray-600"})},void 0,(0,o.Z)(v.xv,{size:"sm"},void 0,g.formatMessage(G.reportContext)))))}()}}(),(0,o.Z)(F,{account:h})))}}}]);
//# sourceMappingURL=report-modal-5ec44d96b6c6aaf57cbd.chunk.js.map