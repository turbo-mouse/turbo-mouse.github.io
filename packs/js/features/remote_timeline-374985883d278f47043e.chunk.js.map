{"version":3,"file":"packs/js/features/remote_timeline-374985883d278f47043e.chunk.js","mappings":"yOAAmoF,UAA71D,SAAwBA,GAAM,IAAIC,EAAOD,EAAKC,OAAWC,GAAQ,UAAiBC,GAAS,UAAqBC,EAASH,aAA+B,EAAOA,EAAOG,SAAaC,GAAS,UAAkBC,GAAO,IAAAC,QAAO,MAAUC,EAAW,SAAaC,IAAYJ,EAASK,MAAM,CAAC,SAAS,QAAQ,cAAkBC,EAAON,EAASK,MAAM,CAAC,kBAAkB,gBAAgBE,SAASR,GAAcS,EAAW,WAAyBP,EAAOQ,SAASR,EAAOQ,SAAW,EAA0d,OAAlQ,IAAAC,YAAU,WAAoL,OAAzKF,IAAaV,GAAS,QAAqBC,EAAS,CAACK,UAAUA,EAAUO,WAAMC,KAAaX,EAAOQ,QAAQX,GAAS,QAAoBC,EAAS,CAACK,UAAUA,KAAoB,WAAWI,IAAaP,EAAOQ,QAAQ,IAAK,CAAE,GAAE,CAACL,KAA+B,OAAK,KAAO,CAACS,MAAMd,EAASe,aAAY,QAAM,EAAOf,IAAuB,OAAK,IAAkB,CAACgB,KAAKhB,KAAYO,IAAqB,OAAK,KAAO,CAACU,UAAU,YAAYC,MAAM,QAAG,GAAoB,OAAK,IAAW,CAACC,cAAc,UAAUC,IAAI,EAAQ,IAAuBC,QAA5uB,WAA4BvB,EAAQwB,KAAK,sBAAuB,KAAotB,OAAK,KAAK,CAAC,OAAE,GAAoB,OAAK,IAAiB,CAACC,GAAG,iCAAiCC,eAAe,8CAA8CC,OAAO,CAACzB,SAASA,QAA2B,OAAK,IAAS,CAAC0B,UAAU,GAAGC,OAAOvB,EAAW,KAAKuB,OAAO3B,EAAS,aAAaI,WAAW,GAAGuB,OAAOvB,GAAYuB,OAAOtB,EAAU,SAAS,GAAG,KAAKsB,OAAO3B,GAAU4B,WAAxiC,SAAwBhB,GAAOb,GAAS,QAAqBC,EAAS,CAACY,MAAMA,EAAMP,UAAUA,IAAa,EAAw9BwB,cAA0B,OAAK,IAAiB,CAACN,GAAG,sBAAsBC,eAAe,8EAA8EC,OAAO,CAACzB,SAASA,KAAY8B,WAAW,UAAW,C,wICA7jFC,EAAe,SAAwBC,GAAuC,OAAnB,QAAYA,GAAuB1B,MAAM,CAAC,kBAAkB,eAAgB,E,cCA6P2B,GAAkB,E,MAAA,MAA4BC,GAAS,QAAe,CAACC,QAAQ,CAAC,GAAK,2BAA2B,eAAiB,cAAcC,UAAU,CAAC,GAAK,6BAA6B,eAAiB,kBAA2zB,EAA1sB,SAA2BxC,GAAM,IAAIoB,EAAKpB,EAAKoB,KAASqB,GAAK,EAAAC,EAAA,KAAcvC,GAAS,UAAqBE,GAAS,UAAkBsC,GAAe,SAAe,SAASP,GAAO,OAAOC,EAAkBD,EAAMhB,EAAM,IAAOT,EAAON,EAASK,MAAM,CAAC,kBAAkB,gBAAgBE,SAASQ,GAAwH,OAAIuB,GAA8C,OAAK,KAAO,CAACC,MAAMD,EAAeE,IAAI,QAAQC,cAAhM,WAAmE3C,EAAtCQ,EDAnqB,SAAmBS,GAAM,OAAO,SAASjB,EAAS4C,GAAU,IAAIX,EAAMW,IAAeC,EAAYb,EAAeC,GAAO,OAAOjC,GAAS,QAAc,CAAC,kBAAkB,eAAe6C,EAAYC,OAAO7B,IAAQ,CAAE,CCA8foB,CAAUpB,GDA37B,SAAiBA,GAAM,OAAO,SAASjB,EAAS4C,GAAU,IAAIX,EAAMW,IAAeC,EAAYb,EAAeC,GAAO,OAAOjC,GAAS,QAAc,CAAC,kBAAkB,eAAe6C,EAAYE,IAAI9B,IAAQ,CAAE,CCAosBmB,CAAQnB,GAAwC,EAA8H+B,WAAkB,EAAPxC,EAAe,IAAwC,KAAyByC,YAAYX,EAAKY,cAAc1C,EAAO2B,EAASE,UAAUF,EAASC,QAAQ,CAACnB,KAAKA,MAA7Q,IAAsR,C,kICAx7BiB,GAAkB,E,MAAA,MAA4BC,GAAS,QAAe,CAACgB,eAAe,CAAC,GAAK,kCAAkC,eAAiB,qBAAigC,UAAv5B,SAAiCtD,GAAM,IAAIoB,EAAKpB,EAAKoB,KAASqB,GAAK,SAActC,GAAS,UAAqBoD,GAAQ,UAAoBZ,GAAe,SAAe,SAASP,GAAO,OAAOC,EAAkBD,EAAMhB,EAAM,IAAsRoC,EAA9H,CAAC,CAACC,KAAKhB,EAAKY,cAAcf,EAASgB,gBAAgBI,OAA/K,WAAgCvD,GAAS,QAAU,kBAAkB,CAACiB,KAAKA,IAAQ,EAAwHuC,KAAK,EAAQ,OAAkD,OAAmB,OAAK,KAAO,CAACf,OAAmB,OAAK,IAAiB,CAACjB,GAAG,2CAA2CC,eAAe,4BAA4B8B,OAAOH,SAAkCA,EAAQK,OAAmB,OAAK,IAAa,CAACC,MAAML,EAAKhC,IAAI,EAAQ,YAAqCP,QAAW,GAAoB,OAAK,IAAqB,CAAC0B,eAAeA,IAAkB,C","sources":["webpack://soapbox/./app/soapbox/features/remote-timeline/index.tsx","webpack://soapbox/./app/soapbox/actions/remote-timeline.ts","webpack://soapbox/./app/soapbox/features/ui/components/instance-info-panel.tsx","webpack://soapbox/./app/soapbox/features/ui/components/instance-moderation-panel.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.includes.js\";import\"core-js/modules/es.string.includes.js\";import\"core-js/modules/es.array.push.js\";import\"core-js/modules/es.array.concat.js\";import React,{useEffect,useRef}from'react';import{FormattedMessage}from'react-intl';import{useHistory}from'react-router-dom';import{connectRemoteStream}from'soapbox/actions/streaming';import{expandRemoteTimeline}from'soapbox/actions/timelines';import IconButton from'soapbox/components/icon-button';import{Column,HStack,Text}from'soapbox/components/ui';import{useAppDispatch,useSettings}from'soapbox/hooks';import Timeline from'../ui/components/timeline';import PinnedHostsPicker from'./components/pinned-hosts-picker';/** View statuses from a remote instance. */var RemoteTimeline=function RemoteTimeline(_ref){var params=_ref.params;var history=useHistory();var dispatch=useAppDispatch();var instance=params===null||params===void 0?void 0:params.instance;var settings=useSettings();var stream=useRef(null);var timelineId='remote';var onlyMedia=!!settings.getIn(['remote','other','onlyMedia']);var pinned=settings.getIn(['remote_timeline','pinnedHosts']).includes(instance);var disconnect=function disconnect(){if(stream.current){stream.current();}};var handleCloseClick=function handleCloseClick(){history.push('/timeline/fediverse');};var handleLoadMore=function handleLoadMore(maxId){dispatch(expandRemoteTimeline(instance,{maxId:maxId,onlyMedia:onlyMedia}));};useEffect(function(){disconnect();dispatch(expandRemoteTimeline(instance,{onlyMedia:onlyMedia,maxId:undefined}));stream.current=dispatch(connectRemoteStream(instance,{onlyMedia:onlyMedia}));return function(){disconnect();stream.current=null;};},[onlyMedia]);return/*#__PURE__*/_jsx(Column,{label:instance,transparent:true},void 0,instance&&/*#__PURE__*/_jsx(PinnedHostsPicker,{host:instance}),!pinned&&/*#__PURE__*/_jsx(HStack,{className:\"mb-4 px-2\",space:2},void 0,/*#__PURE__*/_jsx(IconButton,{iconClassName:\"h-5 w-5\",src:require('@tabler/icons/x.svg'),onClick:handleCloseClick}),/*#__PURE__*/_jsx(Text,{},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"remote_timeline.filter_message\",defaultMessage:\"You are viewing the timeline of {instance}.\",values:{instance:instance}}))),/*#__PURE__*/_jsx(Timeline,{scrollKey:\"\".concat(timelineId,\"_\").concat(instance,\"_timeline\"),timelineId:\"\".concat(timelineId).concat(onlyMedia?':media':'',\":\").concat(instance),onLoadMore:handleLoadMore,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.remote\",defaultMessage:\"There is nothing here! Manually follow users from {instance} to fill it up.\",values:{instance:instance}}),divideType:\"space\"}));};export default RemoteTimeline;","import{getSettings,changeSetting}from'soapbox/actions/settings';var getPinnedHosts=function getPinnedHosts(state){var settings=getSettings(state);return settings.getIn(['remote_timeline','pinnedHosts']);};var pinHost=function pinHost(host){return function(dispatch,getState){var state=getState();var pinnedHosts=getPinnedHosts(state);return dispatch(changeSetting(['remote_timeline','pinnedHosts'],pinnedHosts.add(host)));};};var unpinHost=function unpinHost(host){return function(dispatch,getState){var state=getState();var pinnedHosts=getPinnedHosts(state);return dispatch(changeSetting(['remote_timeline','pinnedHosts'],pinnedHosts.remove(host)));};};export{pinHost,unpinHost};","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.includes.js\";import\"core-js/modules/es.string.includes.js\";import React from'react';import{useIntl,defineMessages}from'react-intl';import{pinHost,unpinHost}from'soapbox/actions/remote-timeline';import{Widget}from'soapbox/components/ui';import{useAppSelector,useAppDispatch,useSettings}from'soapbox/hooks';import{makeGetRemoteInstance}from'soapbox/selectors';var getRemoteInstance=makeGetRemoteInstance();var messages=defineMessages({pinHost:{\"id\":\"remote_instance.pin_host\",\"defaultMessage\":\"Pin {host}\"},unpinHost:{\"id\":\"remote_instance.unpin_host\",\"defaultMessage\":\"Unpin {host}\"}});/** Widget that displays information about a remote instance to users. */var InstanceInfoPanel=function InstanceInfoPanel(_ref){var host=_ref.host;var intl=useIntl();var dispatch=useAppDispatch();var settings=useSettings();var remoteInstance=useAppSelector(function(state){return getRemoteInstance(state,host);});var pinned=settings.getIn(['remote_timeline','pinnedHosts']).includes(host);var handlePinHost=function handlePinHost(){if(!pinned){dispatch(pinHost(host));}else{dispatch(unpinHost(host));}};if(!remoteInstance)return null;return/*#__PURE__*/_jsx(Widget,{title:remoteInstance.get('host'),onActionClick:handlePinHost,actionIcon:pinned?require('@tabler/icons/pinned-off.svg'):require('@tabler/icons/pin.svg'),actionTitle:intl.formatMessage(pinned?messages.unpinHost:messages.pinHost,{host:host})});};export default InstanceInfoPanel;","'use strict';import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{useIntl,defineMessages,FormattedMessage}from'react-intl';import{openModal}from'soapbox/actions/modals';import DropdownMenu from'soapbox/components/dropdown-menu';import{Widget}from'soapbox/components/ui';import InstanceRestrictions from'soapbox/features/federation-restrictions/components/instance-restrictions';import{useAppSelector,useAppDispatch,useOwnAccount}from'soapbox/hooks';import{makeGetRemoteInstance}from'soapbox/selectors';var getRemoteInstance=makeGetRemoteInstance();var messages=defineMessages({editFederation:{\"id\":\"remote_instance.edit_federation\",\"defaultMessage\":\"Edit federation\"}});/** Widget for moderators to manage a remote instance. */var InstanceModerationPanel=function InstanceModerationPanel(_ref){var host=_ref.host;var intl=useIntl();var dispatch=useAppDispatch();var account=useOwnAccount();var remoteInstance=useAppSelector(function(state){return getRemoteInstance(state,host);});var handleEditFederation=function handleEditFederation(){dispatch(openModal('EDIT_FEDERATION',{host:host}));};var makeMenu=function makeMenu(){return[{text:intl.formatMessage(messages.editFederation),action:handleEditFederation,icon:require('@tabler/icons/edit.svg')}];};var menu=makeMenu();return/*#__PURE__*/_jsx(Widget,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"remote_instance.federation_panel.heading\",defaultMessage:\"Federation Restrictions\"}),action:account!==null&&account!==void 0&&account.admin?/*#__PURE__*/_jsx(DropdownMenu,{items:menu,src:require('@tabler/icons/dots-vertical.svg')}):undefined},void 0,/*#__PURE__*/_jsx(InstanceRestrictions,{remoteInstance:remoteInstance}));};export default InstanceModerationPanel;"],"names":["_ref","params","history","dispatch","instance","settings","stream","useRef","timelineId","onlyMedia","getIn","pinned","includes","disconnect","current","useEffect","maxId","undefined","label","transparent","host","className","space","iconClassName","src","onClick","push","id","defaultMessage","values","scrollKey","concat","onLoadMore","emptyMessage","divideType","getPinnedHosts","state","getRemoteInstance","messages","pinHost","unpinHost","intl","useIntl","remoteInstance","title","get","onActionClick","getState","pinnedHosts","remove","add","actionIcon","actionTitle","formatMessage","editFederation","account","menu","text","action","icon","admin","items"],"sourceRoot":""}