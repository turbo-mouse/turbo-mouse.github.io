"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[51],{1425:function(e,t,r){r.r(t),r.d(t,{default:function(){return H}});var a=r(2063),n=r(2053),s=r(1),i=r(2064),o=r(2065),c=r(2),l=(r(5),r(135),r(2094)),u=function(){var e=(0,l.lv)(12,20);return(0,a.Z)(c.Kq,{space:2,className:"animate-pulse"},void 0,(0,a.Z)(c.Kq,{className:"aspect-w-10 aspect-h-7 h-full w-full overflow-hidden rounded-lg"},void 0,(0,a.Z)("div",{className:"absolute inset-0 rounded-t-lg bg-gray-300 object-cover dark:bg-gray-800"}),(0,a.Z)(c.Kq,{justifyContent:"end",className:"z-10 p-4 text-white",space:3},void 0,(0,a.Z)("div",{className:"h-11 w-11 rounded-full bg-gray-500 dark:bg-gray-700 dark:ring-primary-900"}),(0,a.Z)(c.Kq,{space:1,className:"text-gray-500 dark:text-gray-700"},void 0,(0,a.Z)(c.xv,{theme:"inherit",weight:"bold",truncate:!0},void 0,(0,l._4)(e)),(0,a.Z)(c.Ug,{space:3,wrap:!0},void 0,(0,a.Z)(c.xv,{tag:"span",theme:"inherit"},void 0,(0,l._4)(6)),(0,a.Z)(c.xv,{tag:"span",theme:"inherit"},void 0,(0,l._4)(6)))))),(0,a.Z)("div",{className:"h-10 w-full rounded-full bg-gray-300 dark:bg-gray-800"}))},d=r(639),g=r(2083),p=r(2082),v=r(817),m=r(818),h=(0,s.forwardRef)((function(e,t){var r=e.group,n=e.width,i=void 0===n?"auto":n;return(0,a.Z)("div",{className:"relative flex shrink-0 flex-col space-y-2 px-0.5",style:{width:i}},r.id,(0,a.Z)(p.rU,{to:"/groups/".concat(r.id)},void 0,s.createElement(c.Kq,{className:"aspect-w-10 aspect-h-7 h-full w-full overflow-hidden rounded-lg",ref:t,style:{minHeight:180}},r.header&&(0,a.Z)("img",{src:r.header,alt:"Group cover",className:"absolute inset-0 object-cover"}),(0,a.Z)(c.Kq,{justifyContent:"end",className:"z-10 p-4 text-white",space:3},void 0,(0,a.Z)(c.qE,{className:"ring-2 ring-white",src:r.avatar,size:44}),(0,a.Z)(c.Kq,{space:1},void 0,(0,a.Z)(c.xv,{weight:"bold",dangerouslySetInnerHTML:{__html:r.display_name_html},theme:"inherit",truncate:!0}),(0,a.Z)(c.Ug,{alignItems:"center",space:1},void 0,(0,a.Z)(m.Z,{group:r}),(0,a.Z)("span",{},void 0,"•"),(0,a.Z)(v.Z,{group:r})))),(0,a.Z)("div",{className:"absolute inset-x-0 bottom-0 z-0 flex justify-center rounded-b-lg bg-gradient-to-t from-gray-900 to-transparent pt-12 pb-8 transition-opacity duration-500"}))),(0,a.Z)(c.zx,{theme:"primary",block:!0},void 0,r.locked?(0,a.Z)(g.Z,{id:"group.join.private",defaultMessage:"Request Access"}):(0,a.Z)(g.Z,{id:"group.join.public",defaultMessage:"Join Group"})))})),Z=function(){var e=(0,d.r2)(),t=e.groups,r=e.isFetching,i=(0,s.useState)(null),o=(0,n.Z)(i,2),l=o[0],g=o[1];return(0,a.Z)(c.Kq,{space:4},void 0,(0,a.Z)(c.xv,{size:"xl",weight:"bold"},void 0,"Popular Groups"),(0,a.Z)(c.lr,{itemWidth:250,itemCount:t.length,controlsHeight:null==l?void 0:l.clientHeight},void 0,(function(e){var n=e.width;return s.createElement(s.Fragment,null,r?new Array(20).fill(0).map((function(e,t){return(0,a.Z)("div",{className:"relative flex shrink-0 flex-col space-y-2 px-0.5",style:{width:n||"auto"}},t,(0,a.Z)(u,{}))})):t.map((function(e){return s.createElement(h,{key:e.id,group:e,width:n,ref:g})})))})))},f=function(){var e=(0,l.lv)(12,20);return(0,a.Z)(c.Ug,{alignItems:"center",justifyContent:"between",className:"animate-pulse"},void 0,(0,a.Z)(c.Ug,{alignItems:"center",space:2},void 0,(0,a.Z)("div",{className:"h-11 w-11 rounded-full bg-gray-500 dark:bg-gray-700 dark:ring-primary-900"}),(0,a.Z)(c.Kq,{className:"text-gray-500 dark:text-gray-700"},void 0,(0,a.Z)(c.xv,{theme:"inherit",weight:"bold"},void 0,(0,l._4)(e)),(0,a.Z)(c.Ug,{space:1,alignItems:"center"},void 0,(0,a.Z)(c.xv,{theme:"inherit",tag:"span",size:"sm",weight:"medium"},void 0,(0,l._4)(6)),(0,a.Z)("span",{},void 0,"•"),(0,a.Z)(c.xv,{theme:"inherit",tag:"span",size:"sm",weight:"medium"},void 0,(0,l._4)(6))))),(0,a.Z)("div",{className:"h-10 w-36 rounded-full bg-gray-300 dark:bg-gray-800"}))},b=r(3),y=r(2047),w=r(2062),x=(r(50),r(6),r(52),r(12),r(13),r(10),r(0),r(20),r(4),r(8),r(22),r(23),r(9),r(772)),k=r(35),N=r(56),S=r(250);function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){(0,y.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _,j=r(2049),C=(r(19),r(101),r(60),r(7),r(49),r(579)),q=function(){return(0,a.Z)(c.Kq,{space:2,className:"px-4 py-2","data-testid":"no-results"},void 0,(0,a.Z)(c.xv,{weight:"bold",size:"lg"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.no_results.title",defaultMessage:"No matches found"})),(0,a.Z)(c.xv,{theme:"muted"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.no_results.subtitle",defaultMessage:"Try searching for another group."})))},M=r(2105),z=function(e){var t=e.onSelect,i=(0,b.Tr)(),o=(0,s.useState)(C.wy.get(null==i?void 0:i.id)||[]),l=(0,n.Z)(o,2),u=l[0],d=l[1];return(0,a.Z)(c.Kq,{space:2,"data-testid":"recent-searches"},void 0,u.length>0?s.createElement(s.Fragment,null,(0,a.Z)(c.Ug,{alignItems:"center",justifyContent:"between",className:"bg-white dark:bg-gray-900"},void 0,(0,a.Z)(c.xv,{theme:"muted",weight:"semibold",size:"sm"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.recent_searches.title",defaultMessage:"Recent searches"})),(0,a.Z)("button",{onClick:function(){var e;e=null==i?void 0:i.id,C.wy.remove(e),d([])},"data-testid":"clear-recent-searches"},void 0,(0,a.Z)(c.xv,{theme:"primary",size:"sm",className:"hover:underline"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.recent_searches.clear_all",defaultMessage:"Clear all"})))),(0,a.Z)(M.OO,{useWindowScroll:!0,data:u,itemContent:function(e,n){return(0,a.Z)("div",{"data-testid":"recent-search"},n,(0,a.Z)("button",{onClick:function(){return t(n)},className:"group flex w-full flex-col rounded-lg p-2 hover:bg-gray-100 dark:hover:bg-gray-800","data-testid":"recent-search-result"},void 0,(0,a.Z)(c.Ug,{alignItems:"center",space:2},void 0,(0,a.Z)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-gray-200 p-2 dark:bg-gray-800 dark:group-hover:bg-gray-700/20"},void 0,(0,a.Z)(c.JO,{src:r(2034),className:"h-5 w-5 text-gray-600"})),(0,a.Z)(c.xv,{weight:"bold",size:"sm",align:"left"},void 0,n))))}})):(0,a.Z)(c.Kq,{space:2,"data-testid":"recent-searches-blankslate"},void 0,(0,a.Z)(c.xv,{weight:"bold",size:"lg"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.recent_searches.blankslate.title",defaultMessage:"No recent searches"})),(0,a.Z)(c.xv,{theme:"muted"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.recent_searches.blankslate.subtitle",defaultMessage:"Search group names, topics or keywords"}))))},K=r(2081),P=r(2076),U=r(661),R=r(134),E=["context"];!function(e){e.LIST="LIST",e.GRID="GRID"}(_||(_={}));var F=s.forwardRef((function(e,t){e.context;var r=(0,P.Z)(e,E);return s.createElement("div",(0,K.Z)({ref:t},r,{className:"flex flex-wrap"}))})),T=function(e){var t=e.groupSearchResult,i=(0,s.useState)(_.LIST),o=(0,n.Z)(i,2),l=o[0],u=o[1],d=t.groups,p=t.hasNextPage,v=t.isFetching,m=t.fetchNextPage,Z=function(){p&&!v&&m()},f=(0,s.useCallback)((function(e,t){return(0,a.Z)(c.Ug,{alignItems:"center",justifyContent:"between",className:(0,U.default)({"pt-4":0!==t})},void 0,(0,a.Z)(c.Ug,{alignItems:"center",space:2},void 0,(0,a.Z)(c.qE,{className:"ring-2 ring-white dark:ring-primary-900",src:e.avatar,size:44}),(0,a.Z)(c.Kq,{},void 0,(0,a.Z)(c.xv,{weight:"bold",dangerouslySetInnerHTML:{__html:e.display_name_html}}),(0,a.Z)(c.Ug,{className:"text-gray-700 dark:text-gray-600",space:1,alignItems:"center"},void 0,(0,a.Z)(c.JO,{className:"h-4.5 w-4.5",src:e.locked?r(210):r(631)}),(0,a.Z)(c.xv,{theme:"inherit",tag:"span",size:"sm",weight:"medium"},void 0,e.locked?(0,a.Z)(g.Z,{id:"group.privacy.locked",defaultMessage:"Private"}):(0,a.Z)(g.Z,{id:"group.privacy.public",defaultMessage:"Public"})),void 0!==e.members_count&&s.createElement(s.Fragment,null,(0,a.Z)("span",{},void 0,"•"),(0,a.Z)(c.xv,{theme:"inherit",tag:"span",size:"sm",weight:"medium"},void 0,(0,R.w8)(e.members_count)," ",(0,a.Z)(g.Z,{id:"groups.discover.search.results.member_count",defaultMessage:"{members, plural, one {member} other {members}}",values:{members:e.members_count}})))))),(0,a.Z)(c.zx,{theme:"primary"},void 0,e.locked?(0,a.Z)(g.Z,{id:"group.join.private",defaultMessage:"Request Access"}):(0,a.Z)(g.Z,{id:"group.join.public",defaultMessage:"Join Group"})))}),[]),b=(0,s.useCallback)((function(e,t){return(0,a.Z)("div",{className:"pb-4"},void 0,(0,a.Z)(h,{group:e}))}),[]);return(0,a.Z)(c.Kq,{space:4,"data-testid":"results"},void 0,(0,a.Z)(c.Ug,{alignItems:"center",justifyContent:"between"},void 0,(0,a.Z)(c.xv,{weight:"semibold"},void 0,(0,a.Z)(g.Z,{id:"groups.discover.search.results.groups",defaultMessage:"Groups"})),(0,a.Z)(c.Ug,{alignItems:"center"},void 0,(0,a.Z)("button",{onClick:function(){return u(_.LIST)}},void 0,(0,a.Z)(c.JO,{src:r(2035),className:(0,U.default)("h-5 w-5 text-gray-600",{"text-primary-600":l===_.LIST})})),(0,a.Z)("button",{onClick:function(){return u(_.GRID)}},void 0,(0,a.Z)(c.JO,{src:r(2036),className:(0,U.default)("h-5 w-5 text-gray-600",{"text-primary-600":l===_.GRID})})))),l===_.LIST?(0,a.Z)(M.OO,{useWindowScroll:!0,data:d,itemContent:function(e,t){return f(t,e)},endReached:Z}):(0,a.Z)(M.Mr,{useWindowScroll:!0,data:d,itemContent:function(e,t){return b(t,e)},components:{Item:function(e){return s.createElement("div",(0,K.Z)({},e,{className:"w-1/2 flex-none"}))},List:F},endReached:Z}))},D=function(e){var t=e.onSelect,r=e.searchValue,n=(0,b.Tr)(),i=b.Nr,o=i(r,300),l=i(r,1e3),u=function(e){var t,r=(0,b.h_)(),a=(0,b.hz)(),n=function(){var t=(0,w.Z)(regeneratorRuntime.mark((function t(a){var n,s,i,o,c,l,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null==a?void 0:a.link,s=n||"/api/v1/groups/search",t.next=4,r.get(s,{params:e?{q:e}:void 0});case 4:return i=t.sent,o=i.data,c=(0,k.J2)(i),l=!!c,u=o.map(N.yo),t.abrupt("return",{result:u,hasMore:l,link:c});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s=(0,x.useInfiniteQuery)((t=e)?["groups","search",t]:["groups","search"],(function(e){var t=e.pageParam;return n(t)}),{keepPreviousData:!0,enabled:a.groups&&!!e,getNextPageParam:function(e){if(e.hasMore)return{link:e.link}}}),i=(0,S.MH)(s.data);return O(O({},s),{},{groups:i||[]})}(o),d=u.groups,g=u.isFetching,p=u.isFetched,v=p&&d.length>0,m=p&&0===d.length;return(0,s.useEffect)((function(){l&&l.length>=0&&function(e,t){var r=[];if(C.wy.get(e)&&(r=C.wy.get(e)),-1===r.indexOf(t))return r.unshift(t),r.length>10&&r.pop(),C.wy.set(e,r),r;var a=r.indexOf(t),n=(0,j.Z)(r);n.splice.apply(n,[0,0].concat((0,j.Z)(n.splice(a,1)))),localStorage.setItem("soapbox:recent-group-searches",JSON.stringify(n))}(null==n?void 0:n.id,l)}),[l]),g?(0,a.Z)(c.Kq,{space:4},void 0,(0,a.Z)(f,{}),(0,a.Z)(f,{}),(0,a.Z)(f,{})):m?(0,a.Z)(q,{}):v?(0,a.Z)(T,{groupSearchResult:u}):(0,a.Z)(z,{onSelect:t})},G=function(){var e=(0,d.sp)(),t=e.groups,r=e.isFetching,i=(0,s.useState)(null),o=(0,n.Z)(i,2),l=o[0],g=o[1];return(0,a.Z)(c.Kq,{space:4},void 0,(0,a.Z)(c.xv,{size:"xl",weight:"bold"},void 0,"Suggested For You"),(0,a.Z)(c.lr,{itemWidth:250,itemCount:t.length,controlsHeight:null==l?void 0:l.clientHeight},void 0,(function(e){var n=e.width;return s.createElement(s.Fragment,null,r?new Array(20).fill(0).map((function(e,t){return(0,a.Z)("div",{className:"relative flex shrink-0 flex-col space-y-2 px-0.5",style:{width:n||"auto"}},t,(0,a.Z)(u,{}))})):t.map((function(e){return s.createElement(h,{key:e.id,group:e,width:n,ref:g})})))})))},J=r(1084),L=(0,i.vU)({placeholder:{id:"groups.discover.search.placeholder",defaultMessage:"Search"}}),H=function(){var e=(0,o.Z)(),t=(0,s.useState)(!1),i=(0,n.Z)(t,2),l=i[0],u=i[1],d=(0,s.useState)(""),g=(0,n.Z)(d,2),p=g[0],v=g[1],m=p&&p.length>0,h=function(){return v("")};return(0,a.Z)(c.Kq,{space:4},void 0,(0,a.Z)(J.Z,{activeTab:J.l.FIND_GROUPS}),(0,a.Z)(c.Kq,{space:6},void 0,(0,a.Z)(c.Ug,{alignItems:"center"},void 0,l?(0,a.Z)(c.hU,{src:r(197),iconClassName:"mr-2 h-5 w-5 fill-current text-gray-600",onClick:function(){h(),u(!1)}}):null,(0,a.Z)(c.II,{"data-testid":"search",type:"text",placeholder:e.formatMessage(L.placeholder),value:p,onChange:function(e){return v(e.target.value)},onFocus:function(){return u(!0)},outerClassName:"mt-0 w-full",theme:"search",append:(0,a.Z)("button",{onClick:h},void 0,(0,a.Z)(c.JO,{src:r(m?76:185),className:"h-4 w-4 text-gray-700 dark:text-gray-600","aria-hidden":"true"}))})),l?(0,a.Z)(D,{searchValue:p,onSelect:function(e){return v(e)}}):s.createElement(s.Fragment,null,(0,a.Z)(Z,{}),(0,a.Z)(G,{}))))}},2034:function(e,t,r){e.exports=r.p+"packs/icons/hash-c000bc5f.svg"},2036:function(e,t,r){e.exports=r.p+"packs/icons/layout-grid-572853f4.svg"},2035:function(e,t,r){e.exports=r.p+"packs/icons/layout-list-40a74e3e.svg"}}]);
//# sourceMappingURL=discover-a13354732fa2421e10fd.chunk.js.map