"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[62],{756:function(e,t,o){o.r(t),o.d(t,{default:function(){return B}});var i=o(2057),n=(o(14),o(0),o(16),o(9),o(28),o(33),o(90),o(5),o(418)),a=o(1103),s=o(79),l=o.n(s),r=o(1),c=o(2058),u=o(2059),d=o(2077),f=o(224),m=o(252),p=o(66),v=o(280),g=o(1201),Z=o(57),h=o(2),M=o(309),b=o(2097),y=o(2098),w=function(){return(0,i.Z)("div",{className:"bg-white px-4 py-6 dark:bg-primary-900 sm:p-6"},void 0,(0,i.Z)("div",{className:"w-full animate-pulse"},void 0,(0,i.Z)("div",{className:"mb-2"},void 0,(0,i.Z)(y.Z,{minLength:20,maxLength:20})),(0,i.Z)("div",{},void 0,(0,i.Z)(h.Ug,{space:3,alignItems:"center"},void 0,(0,i.Z)("div",{className:"shrink-0"},void 0,(0,i.Z)(M.Z,{size:48})),(0,i.Z)("div",{className:"min-w-0 flex-1"},void 0,(0,i.Z)(b.Z,{minLength:3,maxLength:25})))),(0,i.Z)("div",{className:"mt-4"},void 0,(0,i.Z)(y.Z,{minLength:5,maxLength:120}))))},_=r.memo(w),j=o(3),x=(o(4),o(55)),k=(0,c.vU)({all:{id:"notifications.filter.all",defaultMessage:"All"},mentions:{id:"notifications.filter.mentions",defaultMessage:"Mentions"},favourites:{id:"notifications.filter.favourites",defaultMessage:"Likes"},boosts:{id:"notifications.filter.boosts",defaultMessage:"Reposts"},polls:{id:"notifications.filter.polls",defaultMessage:"Poll results"},follows:{id:"notifications.filter.follows",defaultMessage:"Follows"},emoji_reacts:{id:"notifications.filter.emoji_reacts",defaultMessage:"Emoji reacts"},statuses:{id:"notifications.filter.statuses",defaultMessage:"Updates from people you follow"}}),C=function(){var e=(0,u.Z)(),t=(0,j.TL)(),n=(0,j.rV)(),a=(0,j.hz)(),s=n.getIn(["notifications","quickFilter","active"]),l=n.getIn(["notifications","quickFilter","advanced"]),r=function(e){return function(){return t((0,m.Tv)(e))}},c=[{text:e.formatMessage(k.all),action:r("all"),name:"all"}];return l?(c.push({text:(0,i.Z)(x.Z,{src:o(248)}),title:e.formatMessage(k.mentions),action:r("mention"),name:"mention"}),c.push({text:(0,i.Z)(x.Z,{src:o(983)}),title:e.formatMessage(k.favourites),action:r("favourite"),name:"favourite"}),a.emojiReacts&&c.push({text:(0,i.Z)(x.Z,{src:o(724)}),title:e.formatMessage(k.emoji_reacts),action:r("pleroma:emoji_reaction"),name:"pleroma:emoji_reaction"}),c.push({text:(0,i.Z)(x.Z,{src:o(200)}),title:e.formatMessage(k.boosts),action:r("reblog"),name:"reblog"}),c.push({text:(0,i.Z)(x.Z,{src:o(596)}),title:e.formatMessage(k.polls),action:r("poll"),name:"poll"}),c.push({text:(0,i.Z)(x.Z,{src:o(597)}),title:e.formatMessage(k.statuses),action:r("status"),name:"status"}),c.push({text:(0,i.Z)(x.Z,{src:o(885)}),title:e.formatMessage(k.follows),action:r("follow"),name:"follow"})):c.push({text:e.formatMessage(k.mentions),action:r("mention"),name:"mention"}),(0,i.Z)(h.mQ,{items:c,activeItem:s})},N=o(2042),q=(o(7),o(394)),I=o(2076),L=o(2050),U=o(69),z=o(158),G=o(2073),T=o(94),S=o(82),F=o(890),R=o(38),D=o(997),E={follow:o(885),follow_request:o(885),mention:o(248),favourite:o(983),reblog:o(200),status:o(597),poll:o(596),move:o(718),"pleroma:chat_mention":o(251),"pleroma:emoji_reaction":o(716),user_approved:o(885),update:o(307),"pleroma:event_reminder":o(1410),"pleroma:participation_request":o(902),"pleroma:participation_accepted":o(902)},P=(0,c.Em)({id:"notification.name",defaultMessage:"{link}{others}"}),H=(0,c.vU)({follow:{id:"notification.follow",defaultMessage:"{name} followed you"},follow_request:{id:"notification.follow_request",defaultMessage:"{name} has requested to follow you"},mention:{id:"notification.mentioned",defaultMessage:"{name} mentioned you"},favourite:{id:"notification.favourite",defaultMessage:"{name} liked your post"},reblog:{id:"notification.reblog",defaultMessage:"{name} reposted your post"},status:{id:"notification.status",defaultMessage:"{name} just posted"},poll:{id:"notification.poll",defaultMessage:"A poll you have voted in has ended"},move:{id:"notification.move",defaultMessage:"{name} moved to {targetName}"},"pleroma:chat_mention":{id:"notification.pleroma:chat_mention",defaultMessage:"{name} sent you a message"},"pleroma:emoji_reaction":{id:"notification.pleroma:emoji_reaction",defaultMessage:"{name} reacted to your post"},user_approved:{id:"notification.user_approved",defaultMessage:"Welcome to {instance}!"},update:{id:"notification.update",defaultMessage:"{name} edited a post you interacted with"},"pleroma:event_reminder":{id:"notification.pleroma:event_reminder",defaultMessage:"An event you are participating in starts soon"},"pleroma:participation_request":{id:"notification.pleroma:participation_request",defaultMessage:"{name} wants to join your event"},"pleroma:participation_accepted":{id:"notification.pleroma:participation_accepted",defaultMessage:"You were accepted to join the event"}}),K=function(e,t,o,n,a,s){var l=function(e){return(0,i.Z)("bdi",{},void 0,(0,i.Z)(I.rU,{className:"font-bold text-gray-800 hover:underline dark:text-gray-200",title:e.acct,to:"/@".concat(e.acct),dangerouslySetInnerHTML:{__html:e.display_name_html}}))}(o),r=e.formatMessage(P,{link:l,others:n&&n>0?(0,i.Z)(d.Z,{id:"notification.others",defaultMessage:" + {count, plural, one {# other} other {# others}}",values:{count:n-1}}):""});return e.formatMessage(H[t],{name:r,targetName:a,instance:s})},A=function(e){var t=e.hidden,o=void 0!==t&&t,n=e.onMoveUp,a=e.onMoveDown,s=(0,j.TL)(),l=(0,r.useCallback)((0,R.e4)(),[]),c=(0,j.CG)((function(t){return l(t,e.notification)})),d=(0,L.k6)(),f=(0,u.Z)(),m=(0,j.fz)(),v=c.type,g=c.account,Z=c.status,M=function(){g&&"object"===(0,N.Z)(g)&&d.push("/@".concat(g.acct))},b=(0,r.useCallback)((function(e){null==e||e.preventDefault(),g&&"object"===(0,N.Z)(g)&&s((0,U.Ck)(g))}),[g]),y=(0,r.useCallback)((function(e){Z&&"object"===(0,N.Z)(Z)&&(Z.favourited?s((0,z.m9)(Z)):s((0,z.yF)(Z)))}),[Z]),w=(0,r.useCallback)((function(e){Z&&"object"===(0,N.Z)(Z)&&s((function(t,o){var i=(0,p.Gw)(o()).get("boostModal");Z.reblogged?s((0,z.y_)(Z)):null!=e&&e.shiftKey||!i?s((0,z.UM)(Z)):s((0,G.h7)("BOOST",{status:Z,onReblog:function(e){s((0,z.UM)(e))}}))}))}),[Z]),_=(0,r.useCallback)((function(e){Z&&"object"===(0,N.Z)(Z)&&(Z.hidden?s((0,T.oK)(Z.id)):s((0,T.E1)(Z.id)))}),[Z]),k=function(){n&&n(c.id)},C=function(){a&&a(c.id)},I=c.target&&"object"===(0,N.Z)(c.target)?c.target.acct:"",P=(0,D.lG)(v)&&g&&"object"===(0,N.Z)(g)?K(f,v,g,c.total_count,I,m.title):null,A=(0,D.lG)(v)?function(e,t,o){var i=[t];return i.push(e.formatDate(o,{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric"})),i.join(", ")}(f,f.formatMessage(H[v],{name:g&&"object"===(0,N.Z)(g)?g.acct:"",targetName:I}),c.created_at):"";return(0,i.Z)(q.HotKeys,{handlers:{reply:b,favourite:y,boost:w,mention:b,open:function(){Z&&"object"===(0,N.Z)(Z)&&g&&"object"===(0,N.Z)(g)?d.push("/@".concat(g.acct,"/posts/").concat(Z.id)):M()},openProfile:M,moveUp:k,moveDown:C,toggleHidden:_},"data-testid":"notification"},void 0,(0,i.Z)("div",{className:"notification focusable",tabIndex:0,"aria-label":A},void 0,(0,i.Z)("div",{className:"focusable p-4"},void 0,(0,i.Z)("div",{className:"mb-2"},void 0,(0,i.Z)(h.Ug,{alignItems:"center",space:3},void 0,(0,i.Z)("div",{className:"flex justify-end",style:{flexBasis:48}},void 0,"pleroma:emoji_reaction"===v&&c.emoji?(0,i.Z)(h.dy,{emoji:c.emoji,className:"h-4 w-4 flex-none"}):(0,D.lG)(v)?(0,i.Z)(x.Z,{src:E[v],className:"flex-none text-primary-600 dark:text-primary-400"}):null),(0,i.Z)("div",{className:"truncate"},void 0,(0,i.Z)(h.xv,{theme:"muted",size:"xs",truncate:!0,"data-testid":"message"},void 0,P)))),(0,i.Z)("div",{},void 0,function(){switch(v){case"follow":case"user_approved":return g&&"object"===(0,N.Z)(g)?(0,i.Z)(S.Z,{id:g.id,hidden:o,avatarSize:48}):null;case"follow_request":return g&&"object"===(0,N.Z)(g)?(0,i.Z)(S.Z,{id:g.id,hidden:o,avatarSize:48,actionType:"follow_request"}):null;case"move":return g&&"object"===(0,N.Z)(g)&&c.target&&"object"===(0,N.Z)(c.target)?(0,i.Z)(S.Z,{id:c.target.id,hidden:o,avatarSize:48}):null;case"favourite":case"mention":case"reblog":case"status":case"poll":case"update":case"pleroma:emoji_reaction":case"pleroma:event_reminder":case"pleroma:participation_accepted":case"pleroma:participation_request":return Z&&"object"===(0,N.Z)(Z)?(0,i.Z)(F.Z,{id:Z.id,hidden:o,onMoveDown:C,onMoveUp:k,avatarSize:48,contextType:"notifications"}):null;default:return null}}()))))},V=(0,c.vU)({title:{id:"column.notifications",defaultMessage:"Notifications"},queue:{id:"notifications.queue_label",defaultMessage:"Click to see {count} new {count, plural, one {notification} other {notifications}}"}}),Y=(0,f.P1)([function(e){return(0,p.Gw)(e).getIn(["notifications","quickFilter","show"])},function(e){return(0,p.Gw)(e).getIn(["notifications","quickFilter","active"])},function(e){return(0,a.List)((0,p.Gw)(e).getIn(["notifications","shows"]).filter((function(e){return!e})).keys())},function(e){return e.notifications.items.toList()}],(function(e,t,o,i){return e&&"all"!==t?i.filter((function(e){return null!==e&&t===e.get("type")})):i.filterNot((function(e){return null!==e&&o.includes(e.get("type"))}))})),B=function(){var e=(0,j.TL)(),t=(0,u.Z)(),o=(0,j.rV)(),a=o.getIn(["notifications","quickFilter","show"]),s=o.getIn(["notifications","quickFilter","active"]),c=(0,j.CG)((function(e){return Y(e)})),f=(0,j.CG)((function(e){return e.notifications.isLoading})),p=(0,j.CG)((function(e){return e.notifications.hasMore})),M=(0,j.CG)((function(e){return e.notifications.totalQueuedNotificationsCount||0})),b=(0,r.useRef)(null),y=(0,r.useRef)(null),w=(0,r.useRef)(null),x=(0,r.useCallback)(l()((function(){var t=c.last();e((0,m._P)({maxId:t&&t.get("id")}))}),300,{leading:!0}),[c]),k=(0,r.useCallback)(l()((function(){e((0,m.ws)(!0))}),100),[]),N=(0,r.useCallback)(l()((function(){e((0,m.ws)(!1))}),100),[]),q=function(e){var t=c.findIndex((function(t){return null!==t&&t.get("id")===e}))-1;L(t)},I=function(e){var t=c.findIndex((function(t){return null!==t&&t.get("id")===e}))+1;L(t)},L=function(e){var t;null===(t=b.current)||void 0===t||t.scrollIntoView({index:e,behavior:"smooth",done:function(){var t=y.current,o=null==t?void 0:t.querySelector('[data-index="'.concat(e,'"] .focusable'));o&&o.focus()}})},U=function(){e((0,m.JI)())};(0,r.useEffect)((function(){return U(),e((0,m.ws)(!0)),function(){x.cancel(),k.cancel(),N.cancel(),e((0,m.ws)(!1))}}),[]);var z,G="all"===s?(0,i.Z)(d.Z,{id:"empty_column.notifications",defaultMessage:"You don't have any notifications yet. Interact with others to start the conversation."}):(0,i.Z)(d.Z,{id:"empty_column.notifications_filtered",defaultMessage:"You don't have any notifications of this type yet."}),T=a?(0,i.Z)(C,{}):null;z=f&&w.current?w.current:c.size>0||p?c.map((function(e){return(0,i.Z)(A,{notification:e,onMoveUp:q,onMoveDown:I},e.id)})):null,w.current=z;var S=r.createElement(Z.Z,{ref:b,scrollKey:"notifications",isLoading:f,showLoading:f&&0===c.size,hasMore:p,emptyMessage:G,placeholderComponent:_,placeholderCount:20,onLoadMore:x,onScrollToTop:k,onScroll:N,className:(0,n.default)({"divide-y divide-gray-200 dark:divide-primary-800 divide-solid":c.size>0,"space-y-2":0===c.size})},z);return r.createElement(h.sg,{ref:y,label:t.formatMessage(V.title),withHeader:!1},T,(0,i.Z)(g.Z,{onClick:U,count:M,message:V.queue}),(0,i.Z)(v.Z,{onRefresh:function(){return e((0,m._P)())}},void 0,S))}},1410:function(e,t,o){e.exports=o.p+"packs/icons/calendar-time-b51181b2.svg"}}]);
//# sourceMappingURL=notifications-f16a0e7af4a0e74922e8.chunk.js.map