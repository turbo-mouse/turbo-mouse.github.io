"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[25],{1435:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var a=n(2044),i=n(2054),o=(n(13),n(29),n(10),n(0),n(59),n(5),n(1)),s=n(2055),r=n(2056),c=n(2074),l=n(496),d=n(140),u=n(2070),f=n(3),m=n(2),v=n(2019),p=n(2020),g=n(574),Z=n(2021),h={house:p,street:Z,secondary:Z,zone:v,city:v,administrative:v},_=function(e){var t=e.id,n=(0,f.CG)((function(e){return e.locations.get(t)}));return n?(0,i.Z)(m.Ug,{alignItems:"center",space:2},void 0,(0,i.Z)(m.JO,{src:h[n.type]||g}),(0,i.Z)(m.Kq,{},void 0,(0,i.Z)(m.xv,{},void 0,n.description),(0,i.Z)(m.xv,{size:"xs",theme:"muted"},void 0,[n.street,n.locality,n.country].filter((function(e){return null==e?void 0:e.trim()})).join(" · ")))):null},M=n(653),C=n(914),b=n(205),x=n.n(b),y=n(625),w=n(52),k=function(){},E=(0,s.vU)({placeholder:{id:"location_search.placeholder",defaultMessage:"Find an address"}}),T=function(e){var t=e.onSelected,s=(0,r.Z)(),c=(0,f.TL)(),l=(0,o.useState)((0,C.OrderedSet)()),u=(0,a.Z)(l,2),m=u[0],v=u[1],p=(0,o.useRef)(new AbortController),g=(0,o.useState)(""),Z=(0,a.Z)(g,2),h=Z[0],b=Z[1],T=function(){return!(h.length>0)},S=(0,o.useCallback)(x()((function(e){c((0,d.fL)(e,p.current.signal)).then((function(e){var t=e.map((function(e){return e.origin_id}));v((0,C.OrderedSet)(t))})).catch(k)}),900,{leading:!0,trailing:!0}),[]);return(0,o.useEffect)((function(){""===h&&v((0,C.OrderedSet)())}),[h]),(0,i.Z)("div",{className:"search"},void 0,(0,i.Z)(y.Z,{className:"rounded-full",placeholder:s.formatMessage(E.placeholder),value:h,onChange:function(e){var t=e.target;p.current.abort(),p.current=new AbortController,S(t.value),b(t.value)},suggestions:m.toList(),onSuggestionsFetchRequested:k,onSuggestionsClearRequested:k,onSuggestionSelected:function(e,n,a){"string"==typeof a&&t(a)},searchTokens:[],onKeyDown:function(e){var t,n;"Escape"===e.key&&(null===(t=document.querySelector(".ui"))||void 0===t||null===(n=t.parentElement)||void 0===n||n.focus())},renderSuggestion:_}),(0,i.Z)("div",{role:"button",tabIndex:0,className:"search__icon",onClick:function(e){e.preventDefault(),T()||b("")}},void 0,(0,i.Z)(w.Z,{src:n(198),className:(0,M.default)("svg-icon--search",{active:T()})}),(0,i.Z)(w.Z,{src:n(811),className:(0,M.default)("svg-icon--backspace",{active:!T()}),"aria-label":s.formatMessage(E.placeholder)})))},S=n(809),N=n(80),q=n(955),I=n(93),z=n(82),G=(n(77),n(25),function(e){var t,a=e.disabled,s=e.onSelectFile,r=(0,o.useRef)(null),l=null===(t=(0,f.CG)((function(e){return e.instance.configuration.getIn(["media_attachments","supported_mime_types"])})))||void 0===t?void 0:t.filter((function(e){return e.startsWith("image/")}));return(0,i.Z)(m.Ug,{className:"h-full w-full cursor-pointer text-primary-500 dark:text-accent-blue",space:3,alignItems:"center",justifyContent:"center",element:"label"},void 0,(0,i.Z)(w.Z,{src:n(1310),className:"h-7 w-7",onClick:function(){var e;null===(e=r.current)||void 0===e||e.click()}}),(0,i.Z)(m.xv,{size:"sm",theme:"primary",weight:"semibold",transform:"uppercase"},void 0,(0,i.Z)(c.Z,{id:"compose_event.upload_banner",defaultMessage:"Upload photo"})),o.createElement("input",{ref:r,type:"file",accept:l&&l.toArray().join(","),onChange:function(e){var t;null!==(t=e.target.files)&&void 0!==t&&t.length&&s(e.target.files)},disabled:a,className:"hidden"}))}),U=(0,s.vU)({eventNamePlaceholder:{id:"compose_event.fields.name_placeholder",defaultMessage:"Name"},eventDescriptionPlaceholder:{id:"compose_event.fields.description_placeholder",defaultMessage:"Description"},eventStartTimePlaceholder:{id:"compose_event.fields.start_time_placeholder",defaultMessage:"Event begins on…"},eventEndTimePlaceholder:{id:"compose_event.fields.end_time_placeholder",defaultMessage:"Event ends on…"},resetLocation:{id:"compose_event.reset_location",defaultMessage:"Reset location"},edit:{id:"compose_event.tabs.edit",defaultMessage:"Edit details"},pending:{id:"compose_event.tabs.pending",defaultMessage:"Manage requests"},authorize:{id:"compose_event.participation_requests.authorize",defaultMessage:"Authorize"},reject:{id:"compose_event.participation_requests.reject",defaultMessage:"Reject"},confirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},cancelEditing:{id:"confirmations.cancel_editing.confirm",defaultMessage:"Cancel editing"}}),D=function(e){var t=e.eventId,n=e.id,a=e.participationMessage,o=(0,r.Z)(),s=(0,f.TL)();return(0,i.Z)(N.Z,{id:n,note:a||void 0,action:(0,i.Z)(m.Ug,{space:2},void 0,(0,i.Z)(m.zx,{theme:"secondary",size:"sm",text:o.formatMessage(U.authorize),onClick:function(){s((0,d.Qq)(t,n))}}),(0,i.Z)(m.zx,{theme:"danger",size:"sm",text:o.formatMessage(U.reject),onClick:function(){s((0,d.my)(t,n))}}))})},O=function(e){var t,s,v=e.onClose,p=(0,r.Z)(),g=(0,f.TL)(),Z=(0,o.useState)("edit"),_=(0,a.Z)(Z,2),M=_[0],C=_[1],b=(0,f.CG)((function(e){return e.compose_event.banner})),x=(0,f.CG)((function(e){return e.compose_event.is_uploading})),y=(0,f.CG)((function(e){return e.compose_event.name})),w=(0,f.CG)((function(e){return e.compose_event.status})),k=(0,f.CG)((function(e){return e.compose_event.start_time})),E=(0,f.CG)((function(e){return e.compose_event.end_time})),N=(0,f.CG)((function(e){return e.compose_event.approval_required})),O=(0,f.CG)((function(e){return e.compose_event.location})),j=(0,f.CG)((function(e){return e.compose_event.id})),F=(0,f.CG)((function(e){return e.compose_event.is_submitting})),P=function(e){g((0,d.CF)(e))},A=function(e){g((0,d.V_)(e))},K=function(e){g((0,d.JP)(e))},L=(0,f.CG)((function(e){var t;return null===(t=e.user_lists.event_participation_requests.get(j))||void 0===t?void 0:t.items}));return(0,o.useEffect)((function(){j&&g((0,d.AK)(j))}),[]),t="edit"===M?(0,i.Z)(m.l0,{},void 0,(0,i.Z)(m.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.banner_label",defaultMessage:"Event banner"})},void 0,(0,i.Z)("div",{className:"dark:sm:shadow-inset relative flex h-24 items-center justify-center overflow-hidden rounded-lg bg-primary-100 text-primary-500 dark:bg-gray-800 dark:text-white sm:h-32 sm:shadow"},void 0,b?o.createElement(o.Fragment,null,(0,i.Z)("img",{className:"h-full w-full object-cover",src:b.url,alt:""}),(0,i.Z)(m.hU,{className:"absolute top-2 right-2",src:n(78),onClick:function(){g((0,d.Qi)())}})):(0,i.Z)(G,{disabled:x,onSelectFile:function(e){g((0,d.ZK)(e[0],p))}}))),(0,i.Z)(m.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.name_label",defaultMessage:"Event name"})},void 0,(0,i.Z)(m.II,{type:"text",placeholder:p.formatMessage(U.eventNamePlaceholder),value:y,onChange:function(e){var t=e.target;g((0,d.ux)(t.value))}})),(0,i.Z)(m.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.description_label",defaultMessage:"Event description"}),hintText:(0,i.Z)(c.Z,{id:"compose_event.fields.description_hint",defaultMessage:"Markdown syntax is supported"})},void 0,(0,i.Z)(m.gx,{autoComplete:"off",placeholder:p.formatMessage(U.eventDescriptionPlaceholder),value:w,onChange:function(e){var t=e.target;g((0,d.y4)(t.value))}})),(0,i.Z)(m.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.location_label",defaultMessage:"Event location"})},void 0,O?O&&(0,i.Z)(m.Ug,{className:"h-[38px] text-gray-700 dark:text-gray-500",alignItems:"center",space:2},void 0,(0,i.Z)(m.JO,{src:h[O.type]||n(574)}),(0,i.Z)(m.Kq,{className:"grow"},void 0,(0,i.Z)(m.xv,{},void 0,O.description),(0,i.Z)(m.xv,{theme:"muted",size:"xs"},void 0,[O.street,O.locality,O.country].filter((function(e){return e.trim()})).join(" · "))),(0,i.Z)(m.hU,{title:p.formatMessage(U.resetLocation),src:n(78),onClick:function(){return K(null)}})):(0,i.Z)(T,{onSelected:K})),(0,i.Z)(m.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.start_time_label",defaultMessage:"Event start date"})},void 0,(0,i.Z)(I.Z,{fetchComponent:z.Mt},void 0,(function(e){return(0,i.Z)(e,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:p.formatMessage(U.eventStartTimePlaceholder),filterDate:q.isCurrentOrFutureDate,selected:k,onChange:P})}))),(0,i.Z)(m.Ug,{alignItems:"center",space:2},void 0,(0,i.Z)(l.Z,{icons:!1,checked:!!E,onChange:function(e){var t=e.target;g((0,d.hY)(t.checked))}}),(0,i.Z)(m.xv,{tag:"span",theme:"muted"},void 0,(0,i.Z)(c.Z,{id:"compose_event.fields.has_end_time",defaultMessage:"The event has end date"}))),E&&(0,i.Z)(m.cw,{labelText:(0,i.Z)(c.Z,{id:"compose_event.fields.end_time_label",defaultMessage:"Event end date"})},void 0,(0,i.Z)(I.Z,{fetchComponent:z.Mt},void 0,(function(e){return(0,i.Z)(e,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:p.formatMessage(U.eventEndTimePlaceholder),filterDate:q.isCurrentOrFutureDate,selected:E,onChange:A})}))),!j&&(0,i.Z)(m.Ug,{alignItems:"center",space:2},void 0,(0,i.Z)(l.Z,{icons:!1,checked:N,onChange:function(e){var t=e.target;g((0,d.cU)(t.checked))}}),(0,i.Z)(m.xv,{tag:"span",theme:"muted"},void 0,(0,i.Z)(c.Z,{id:"compose_event.fields.approval_required",defaultMessage:"I want to approve participation requests manually"})))):L?(0,i.Z)(m.Kq,{space:3},void 0,L.size>0?L.map((function(e){var t=e.account,n=e.participation_message;return(0,i.Z)(D,{eventId:j,id:t,participationMessage:n},t)})):(0,i.Z)(c.Z,{id:"empty_column.event_participant_requests",defaultMessage:"There are no pending event participation requests."})):(0,i.Z)(m.$j,{}),(0,i.Z)(m.u_,{title:j?(0,i.Z)(c.Z,{id:"navigation_bar.compose_event",defaultMessage:"Manage event"}):(0,i.Z)(c.Z,{id:"navigation_bar.create_event",defaultMessage:"Create new event"}),confirmationAction:"edit"===M?function(){g((0,d.X_)())}:void 0,confirmationText:j?(0,i.Z)(c.Z,{id:"compose_event.update",defaultMessage:"Update"}):(0,i.Z)(c.Z,{id:"compose_event.create",defaultMessage:"Create"}),confirmationDisabled:F,onClose:function(){g((function(e,t){(0,S.ox)(t().compose_event)?e((0,u.h7)("CONFIRM",{icon:n(97),heading:j?(0,i.Z)(c.Z,{id:"confirmations.cancel_event_editing.heading",defaultMessage:"Cancel event editing"}):(0,i.Z)(c.Z,{id:"confirmations.delete_event.heading",defaultMessage:"Delete event"}),message:j?(0,i.Z)(c.Z,{id:"confirmations.cancel_event_editing.message",defaultMessage:"Are you sure you want to cancel editing this event? All changes will be lost."}):(0,i.Z)(c.Z,{id:"confirmations.delete_event.message",defaultMessage:"Are you sure you want to delete this event?"}),confirm:p.formatMessage(U.confirm),onConfirm:function(){e((0,u.Mr)("COMPOSE_EVENT")),e((0,d.ZB)())}})):v("COMPOSE_EVENT")}))}},void 0,(0,i.Z)(m.Kq,{space:2},void 0,j&&(s=[{text:p.formatMessage(U.edit),action:function(){return C("edit")},name:"edit"},{text:p.formatMessage(U.pending),action:function(){return C("pending")},name:"pending"}],(0,i.Z)(m.mQ,{items:s,activeItem:M})),t))}},2019:function(e,t,n){e.exports=n.p+"packs/icons/building-community-c07bf903.svg"},2020:function(e,t,n){e.exports=n.p+"packs/icons/home-2-c7fe02f7.svg"},2021:function(e,t,n){e.exports=n.p+"packs/icons/road-c2c24223.svg"}}]);
//# sourceMappingURL=compose_event_modal-a7d442d2d55aa81f7aac.chunk.js.map