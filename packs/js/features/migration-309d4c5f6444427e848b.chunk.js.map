{"version":3,"file":"packs/js/features/migration-309d4c5f6444427e848b.chunk.js","mappings":"mNAAgeA,GAAS,QAAe,CAACC,QAAQ,CAAC,GAAK,mBAAmB,eAAiB,qBAAqBC,OAAO,CAAC,GAAK,mBAAmB,eAAiB,kBAAkBC,mBAAmB,CAAC,GAAK,iCAAiC,eAAiB,+BAA+BC,gBAAgB,CAAC,GAAK,8BAA8B,eAAiB,6BAA6BC,8BAA8B,CAAC,GAAK,8CAA8C,eAAiB,qEAAqEC,eAAe,CAAC,GAAK,8BAA8B,eAAiB,6BAA6BC,qBAAqB,CAAC,GAAK,oCAAoC,eAAiB,mBAAmBC,0BAA0B,CAAC,GAAK,0CAA0C,eAAiB,sBAAupG,UAAnnG,WAAqB,IAAIC,GAAK,SAAcC,GAAS,UAAgDC,GAAlB,UAA0CC,QAAQC,MAAM,CAAC,WAAW,8BAAkCC,GAAU,IAAAC,UAAS,IAAIC,GAAW,OAAeF,EAAU,GAAGG,EAAcD,EAAW,GAAGE,EAAiBF,EAAW,GAAOG,GAAW,IAAAJ,UAAS,IAAIK,GAAW,OAAeD,EAAW,GAAGE,EAASD,EAAW,GAAGE,EAAYF,EAAW,GAAOG,GAAW,IAAAR,WAAS,GAAOS,GAAW,OAAeD,EAAW,GAAGE,EAAUD,EAAW,GAAGE,EAAaF,EAAW,GAAOG,EAAkB,SAA2BC,GAAsB,aAAhBA,EAAEC,OAAOC,KAAkBR,EAAYM,EAAEC,OAAOE,OAAYb,EAAiBU,EAAEC,OAAOE,MAAO,EAAgFC,EAAa,SAAsBJ,GAAsB,OAAnBF,GAAa,GAAahB,GAAS,QAAYO,EAAcI,IAAWY,MAAK,WAA9Jf,EAAiB,IAAII,EAAY,IAAoJ,YAAcb,EAAKyB,cAAclC,EAASG,oBAAqB,IAAGgC,OAAM,SAASC,GAAO,IAAIC,EAAgBC,EAAyBC,EAAQ9B,EAAKyB,cAAclC,EAASI,iBAAiP,qCAA5K,QAAlCiC,EAAgBD,EAAMI,gBAAoC,IAAlBH,GAA8E,QAA7CC,EAAqBD,EAAgBI,YAAqC,IAAvBH,OAA3D,EAAgGA,EAAqBF,SAA2DG,EAAQ9B,EAAKyB,cAAclC,EAASK,gCAAgC,UAAYkC,EAAS,IAAGN,MAAK,WAAWP,GAAa,EAAO,GAAG,EAAE,OAAmB,OAAK,KAAO,CAACgB,MAAMjC,EAAKyB,cAAclC,EAASC,eAAU,GAAoB,OAAK,KAAK,CAAC0C,SAASX,QAAc,GAAoB,OAAK,KAAK,CAACY,MAAM,cAAS,GAAoB,OAAK,IAAiB,CAACC,GAAG,iBAAiBC,eAAe,qJAAqJC,OAAO,CAACC,MAAkB,OAAK,KAAK,CAACC,UAAU,4GAA4GC,GAAG,0BAAqB,GAAoB,OAAK,IAAiB,CAACL,GAAG,sBAAsBC,eAAe,kCAAkCnC,GAA6B,gBAAoB,WAAe,KAAK,KAAiB,OAAK,IAAiB,CAACkC,GAAG,iCAAiCC,eAAe,iJAAiJC,OAAO,CAACpC,eAAeA,QAAiC,OAAK,KAAU,CAACwC,UAAU1C,EAAKyB,cAAclC,EAASM,sBAAiB,GAAoB,OAAK,KAAM,CAACwB,KAAK,gBAAgBsB,YAAY3C,EAAKyB,cAAclC,EAASO,sBAAsB8C,SAAS1B,EAAkBI,MAAMd,EAAcqC,UAAS,MAAqB,OAAK,KAAU,CAACH,UAAU1C,EAAKyB,cAAclC,EAASQ,iCAA4B,GAAoB,OAAK,KAAM,CAAC+C,KAAK,WAAWzB,KAAK,WAAWuB,SAAS1B,EAAkBI,MAAMV,EAASiC,UAAS,MAAqB,OAAK,KAAY,CAAC,OAAE,GAAoB,OAAK,KAAO,CAACV,MAAM,UAAUY,KAAK/C,EAAKyB,cAAclC,EAASE,QAAQuD,QAAQzB,EAAa0B,SAASjC,MAAe,C","sources":["webpack://soapbox/./app/soapbox/features/migration/index.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{defineMessages,FormattedMessage,useIntl}from'react-intl';import{Link}from'react-router-dom';import{moveAccount}from'soapbox/actions/security';import{Button,Column,Form,FormActions,FormGroup,Input,Text}from'soapbox/components/ui';import{useAppDispatch,useInstance}from'soapbox/hooks';import toast from'soapbox/toast';var messages=defineMessages({heading:{\"id\":\"column.migration\",\"defaultMessage\":\"Account migration\"},submit:{\"id\":\"migration.submit\",\"defaultMessage\":\"Move followers\"},moveAccountSuccess:{\"id\":\"migration.move_account.success\",\"defaultMessage\":\"Account successfully moved.\"},moveAccountFail:{\"id\":\"migration.move_account.fail\",\"defaultMessage\":\"Account migration failed.\"},moveAccountFailCooldownPeriod:{\"id\":\"migration.move_account.fail.cooldown_period\",\"defaultMessage\":\"You have moved your account too recently. Please try again later.\"},acctFieldLabel:{\"id\":\"migration.fields.acct.label\",\"defaultMessage\":\"Handle of the new account\"},acctFieldPlaceholder:{\"id\":\"migration.fields.acct.placeholder\",\"defaultMessage\":\"username@domain\"},currentPasswordFieldLabel:{\"id\":\"migration.fields.confirm_password.label\",\"defaultMessage\":\"Current password\"}});var Migration=function Migration(){var intl=useIntl();var dispatch=useAppDispatch();var instance=useInstance();var cooldownPeriod=instance.pleroma.getIn(['metadata','migration_cooldown_period']);var _useState=useState(''),_useState2=_slicedToArray(_useState,2),targetAccount=_useState2[0],setTargetAccount=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var handleInputChange=function handleInputChange(e){if(e.target.name==='password')setPassword(e.target.value);else setTargetAccount(e.target.value);};var clearForm=function clearForm(){setTargetAccount('');setPassword('');};var handleSubmit=function handleSubmit(e){setIsLoading(true);return dispatch(moveAccount(targetAccount,password)).then(function(){clearForm();toast.success(intl.formatMessage(messages.moveAccountSuccess));}).catch(function(error){var _error$response,_error$response$data;var message=intl.formatMessage(messages.moveAccountFail);var errorMessage=(_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error;if(errorMessage==='You are within cooldown period.'){message=intl.formatMessage(messages.moveAccountFailCooldownPeriod);}toast.error(message);}).then(function(){setIsLoading(false);});};return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.heading)},void 0,/*#__PURE__*/_jsx(Form,{onSubmit:handleSubmit},void 0,/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"migration.hint\",defaultMessage:\"This will move your followers to the new account. No other data will be moved. To perform migration, you need to {link} on your new account first.\",values:{link:/*#__PURE__*/_jsx(Link,{className:\"text-primary-600 hover:text-primary-800 hover:underline dark:text-primary-400 dark:hover:text-primary-500\",to:\"/settings/aliases\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"migration.hint.link\",defaultMessage:\"create an account alias\"}))}}),!!cooldownPeriod&&/*#__PURE__*/React.createElement(React.Fragment,null,' ',/*#__PURE__*/_jsx(FormattedMessage,{id:\"migration.hint.cooldown_period\",defaultMessage:\"If you migrate your account, you will not be able to migrate your account for {cooldownPeriod, plural, one {one day} other {the next # days}}.\",values:{cooldownPeriod:cooldownPeriod}}))),/*#__PURE__*/_jsx(FormGroup,{labelText:intl.formatMessage(messages.acctFieldLabel)},void 0,/*#__PURE__*/_jsx(Input,{name:\"targetAccount\",placeholder:intl.formatMessage(messages.acctFieldPlaceholder),onChange:handleInputChange,value:targetAccount,required:true})),/*#__PURE__*/_jsx(FormGroup,{labelText:intl.formatMessage(messages.currentPasswordFieldLabel)},void 0,/*#__PURE__*/_jsx(Input,{type:\"password\",name:\"password\",onChange:handleInputChange,value:password,required:true})),/*#__PURE__*/_jsx(FormActions,{},void 0,/*#__PURE__*/_jsx(Button,{theme:\"primary\",text:intl.formatMessage(messages.submit),onClick:handleSubmit,disabled:isLoading}))));};export default Migration;"],"names":["messages","heading","submit","moveAccountSuccess","moveAccountFail","moveAccountFailCooldownPeriod","acctFieldLabel","acctFieldPlaceholder","currentPasswordFieldLabel","intl","dispatch","cooldownPeriod","pleroma","getIn","_useState","useState","_useState2","targetAccount","setTargetAccount","_useState3","_useState4","password","setPassword","_useState5","_useState6","isLoading","setIsLoading","handleInputChange","e","target","name","value","handleSubmit","then","formatMessage","catch","error","_error$response","_error$response$data","message","response","data","label","onSubmit","theme","id","defaultMessage","values","link","className","to","labelText","placeholder","onChange","required","type","text","onClick","disabled"],"sourceRoot":""}