{"version":3,"file":"packs/js/features/conversations-89006b099f5b4a6197a2.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/features/conversations/components/conversation.tsx","webpack://soapbox/./app/soapbox/features/conversations/components/conversations-list.tsx","webpack://soapbox/./app/soapbox/features/conversations/index.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.find.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.array.map.js\";import\"core-js/modules/es.array.push.js\";import React from'react';import{useHistory}from'react-router-dom';import{markConversationRead}from'soapbox/actions/conversations';import StatusContainer from'soapbox/containers/status-container';import{useAppDispatch,useAppSelector}from'soapbox/hooks';var Conversation=function Conversation(_ref){var conversationId=_ref.conversationId,onMoveUp=_ref.onMoveUp,onMoveDown=_ref.onMoveDown;var dispatch=useAppDispatch();var history=useHistory();var _useAppSelector=useAppSelector(function(state){var conversation=state.conversations.items.find(function(x){return x.id===conversationId;});return{accounts:conversation.accounts.map(function(accountId){return state.accounts.get(accountId,null);}),unread:conversation.unread,lastStatusId:conversation.last_status||null};}),accounts=_useAppSelector.accounts,unread=_useAppSelector.unread,lastStatusId=_useAppSelector.lastStatusId;var handleClick=function handleClick(){if(unread){dispatch(markConversationRead(conversationId));}history.push(\"/statuses/\".concat(lastStatusId));};var handleHotkeyMoveUp=function handleHotkeyMoveUp(){onMoveUp(conversationId);};var handleHotkeyMoveDown=function handleHotkeyMoveDown(){onMoveDown(conversationId);};if(lastStatusId===null){return null;}return/*#__PURE__*/ (// @ts-ignore\n_jsx(StatusContainer,{id:lastStatusId,unread:unread,otherAccounts:accounts,onMoveUp:handleHotkeyMoveUp,onMoveDown:handleHotkeyMoveDown,onClick:handleClick}));};export default Conversation;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.find-index.js\";import\"core-js/modules/es.array.map.js\";import debounce from'lodash/debounce';import React,{useRef}from'react';import{FormattedMessage}from'react-intl';import{expandConversations}from'soapbox/actions/conversations';import ScrollableList from'soapbox/components/scrollable-list';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import Conversation from'./conversation';var ConversationsList=function ConversationsList(){var dispatch=useAppDispatch();var ref=useRef(null);var conversations=useAppSelector(function(state){return state.conversations.items;});var isLoading=useAppSelector(function(state){return state.conversations.isLoading;});var hasMore=useAppSelector(function(state){return state.conversations.hasMore;});var getCurrentIndex=function getCurrentIndex(id){return conversations.findIndex(function(x){return x.id===id;});};var handleMoveUp=function handleMoveUp(id){var elementIndex=getCurrentIndex(id)-1;selectChild(elementIndex);};var handleMoveDown=function handleMoveDown(id){var elementIndex=getCurrentIndex(id)+1;selectChild(elementIndex);};var selectChild=function selectChild(index){var _ref$current;(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.scrollIntoView({index:index,behavior:'smooth',done:function done(){var element=document.querySelector(\"#direct-list [data-index=\\\"\".concat(index,\"\\\"] .focusable\"));if(element){element.focus();}}});};var handleLoadOlder=debounce(function(){var maxId=conversations.getIn([-1,'id']);if(maxId)dispatch(expandConversations({maxId:maxId}));},300,{leading:true});return/*#__PURE__*/React.createElement(ScrollableList,{hasMore:hasMore,onLoadMore:handleLoadOlder,id:\"direct-list\",scrollKey:\"direct\",ref:ref,isLoading:isLoading,showLoading:isLoading&&conversations.size===0,emptyMessage:/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.direct\",defaultMessage:\"You don't have any direct messages yet. When you send or receive one, it will show up here.\"})},conversations.map(function(item){return/*#__PURE__*/_jsx(Conversation,{conversationId:item.id,onMoveUp:handleMoveUp,onMoveDown:handleMoveDown},item.id);}));};export default ConversationsList;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React,{useEffect}from'react';import{defineMessages,useIntl}from'react-intl';import{directComposeById}from'soapbox/actions/compose';import{mountConversations,unmountConversations,expandConversations}from'soapbox/actions/conversations';import{connectDirectStream}from'soapbox/actions/streaming';import AccountSearch from'soapbox/components/account-search';import{Column}from'soapbox/components/ui';import{useAppDispatch}from'soapbox/hooks';import ConversationsList from'./components/conversations-list';var messages=defineMessages({title:{\"id\":\"column.direct\",\"defaultMessage\":\"Direct messages\"},searchPlaceholder:{\"id\":\"direct.search_placeholder\",\"defaultMessage\":\"Send a message to\\u2026\"}});var ConversationsTimeline=function ConversationsTimeline(){var intl=useIntl();var dispatch=useAppDispatch();useEffect(function(){dispatch(mountConversations());dispatch(expandConversations());var disconnect=dispatch(connectDirectStream());return function(){dispatch(unmountConversations());disconnect();};},[]);var handleSuggestion=function handleSuggestion(accountId){dispatch(directComposeById(accountId));};return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.title)},void 0,/*#__PURE__*/_jsx(AccountSearch,{placeholder:intl.formatMessage(messages.searchPlaceholder),onSelected:handleSuggestion}),/*#__PURE__*/_jsx(ConversationsList,{}));};export default ConversationsTimeline;"],"names":["_ref","conversationId","onMoveUp","onMoveDown","dispatch","history","_useAppSelector","state","conversation","conversations","items","find","x","id","accounts","map","accountId","get","unread","lastStatusId","last_status","otherAccounts","onClick","push","concat","ref","useRef","isLoading","hasMore","getCurrentIndex","findIndex","handleMoveUp","elementIndex","selectChild","handleMoveDown","index","_ref$current","current","scrollIntoView","behavior","done","element","document","querySelector","focus","handleLoadOlder","maxId","getIn","leading","onLoadMore","scrollKey","showLoading","size","emptyMessage","defaultMessage","item","messages","title","searchPlaceholder","intl","useIntl","useEffect","disconnect","label","formatMessage","placeholder","onSelected"],"sourceRoot":""}