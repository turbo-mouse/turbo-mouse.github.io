{"version":3,"file":"packs/js/features/export_data-6e69b1d87824d7ba9979.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/actions/export-data.ts","webpack://soapbox/./app/soapbox/features/export-data/components/csv-exporter.tsx","webpack://soapbox/./app/soapbox/features/export-data/index.tsx"],"sourcesContent":["import _asyncToGenerator from\"@babel/runtime/helpers/esm/asyncToGenerator\";import\"regenerator-runtime/runtime.js\";import\"core-js/modules/es.array.find.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.array.push.js\";import\"core-js/modules/es.array.map.js\";import\"core-js/modules/es.array.from.js\";import\"core-js/modules/es.string.iterator.js\";import\"core-js/modules/es.array.iterator.js\";import\"core-js/modules/es.set.js\";import\"core-js/modules/web.dom-collections.iterator.js\";import\"core-js/modules/es.array.unshift.js\";import{defineMessages}from'react-intl';import api,{getLinks}from'soapbox/api';import{normalizeAccount}from'soapbox/normalizers';import toast from'soapbox/toast';export var EXPORT_FOLLOWS_REQUEST='EXPORT_FOLLOWS_REQUEST';export var EXPORT_FOLLOWS_SUCCESS='EXPORT_FOLLOWS_SUCCESS';export var EXPORT_FOLLOWS_FAIL='EXPORT_FOLLOWS_FAIL';export var EXPORT_BLOCKS_REQUEST='EXPORT_BLOCKS_REQUEST';export var EXPORT_BLOCKS_SUCCESS='EXPORT_BLOCKS_SUCCESS';export var EXPORT_BLOCKS_FAIL='EXPORT_BLOCKS_FAIL';export var EXPORT_MUTES_REQUEST='EXPORT_MUTES_REQUEST';export var EXPORT_MUTES_SUCCESS='EXPORT_MUTES_SUCCESS';export var EXPORT_MUTES_FAIL='EXPORT_MUTES_FAIL';var messages=defineMessages({blocksSuccess:{\"id\":\"export_data.success.blocks\",\"defaultMessage\":\"Blocks exported successfully\"},followersSuccess:{\"id\":\"export_data.success.followers\",\"defaultMessage\":\"Followers exported successfully\"},mutesSuccess:{\"id\":\"export_data.success.mutes\",\"defaultMessage\":\"Mutes exported successfully\"}});function fileExport(content,fileName){var fileToDownload=document.createElement('a');fileToDownload.setAttribute('href','data:text/csv;charset=utf-8,'+encodeURIComponent(content));fileToDownload.setAttribute('download',fileName);fileToDownload.style.display='none';document.body.appendChild(fileToDownload);fileToDownload.click();document.body.removeChild(fileToDownload);}var listAccounts=function listAccounts(getState){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function _callee(apiResponse){var followings,accounts,next;return regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:followings=apiResponse.data;accounts=[];next=getLinks(apiResponse).refs.find(function(link){return link.rel==='next';});case 3:if(!next){_context.next=11;break;}_context.next=6;return api(getState).get(next.uri);case 6:apiResponse=_context.sent;next=getLinks(apiResponse).refs.find(function(link){return link.rel==='next';});Array.prototype.push.apply(followings,apiResponse.data);_context.next=3;break;case 11:accounts=followings.map(function(account){return normalizeAccount(account).fqn;});return _context.abrupt(\"return\",Array.from(new Set(accounts)));case 13:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var exportFollows=function exportFollows(){return function(dispatch,getState){dispatch({type:EXPORT_FOLLOWS_REQUEST});var me=getState().me;return api(getState).get(\"/api/v1/accounts/\".concat(me,\"/following?limit=40\")).then(listAccounts(getState)).then(function(followings){followings=followings.map(function(fqn){return fqn+',true';});followings.unshift('Account address,Show boosts');fileExport(followings.join('\\n'),'export_followings.csv');toast.success(messages.followersSuccess);dispatch({type:EXPORT_FOLLOWS_SUCCESS});}).catch(function(error){dispatch({type:EXPORT_FOLLOWS_FAIL,error:error});});};};export var exportBlocks=function exportBlocks(){return function(dispatch,getState){dispatch({type:EXPORT_BLOCKS_REQUEST});return api(getState).get('/api/v1/blocks?limit=40').then(listAccounts(getState)).then(function(blocks){fileExport(blocks.join('\\n'),'export_block.csv');toast.success(messages.blocksSuccess);dispatch({type:EXPORT_BLOCKS_SUCCESS});}).catch(function(error){dispatch({type:EXPORT_BLOCKS_FAIL,error:error});});};};export var exportMutes=function exportMutes(){return function(dispatch,getState){dispatch({type:EXPORT_MUTES_REQUEST});return api(getState).get('/api/v1/mutes?limit=40').then(listAccounts(getState)).then(function(mutes){fileExport(mutes.join('\\n'),'export_mutes.csv');toast.success(messages.mutesSuccess);dispatch({type:EXPORT_MUTES_SUCCESS});}).catch(function(error){dispatch({type:EXPORT_MUTES_FAIL,error:error});});};};","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useIntl}from'react-intl';import{Button,Form,FormActions,Text}from'soapbox/components/ui';import{useAppDispatch}from'soapbox/hooks';var CSVExporter=function CSVExporter(_ref){var messages=_ref.messages,action=_ref.action;var dispatch=useAppDispatch();var intl=useIntl();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var handleClick=function handleClick(event){setIsLoading(true);dispatch(action()).then(function(){setIsLoading(false);}).catch(function(){setIsLoading(false);});};return/*#__PURE__*/_jsx(Form,{},void 0,/*#__PURE__*/_jsx(Text,{size:\"xl\",weight:\"bold\"},void 0,intl.formatMessage(messages.input_label)),/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,intl.formatMessage(messages.input_hint)),/*#__PURE__*/_jsx(FormActions,{},void 0,/*#__PURE__*/_jsx(Button,{theme:\"primary\",onClick:handleClick,disabled:isLoading},void 0,intl.formatMessage(messages.submit))));};export default CSVExporter;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{defineMessages,useIntl}from'react-intl';import{exportFollows,exportBlocks,exportMutes}from'soapbox/actions/export-data';import{Column}from'soapbox/components/ui';import CSVExporter from'./components/csv-exporter';var messages=defineMessages({heading:{\"id\":\"column.export_data\",\"defaultMessage\":\"Export data\"},submit:{\"id\":\"export_data.actions.export\",\"defaultMessage\":\"Export\"}});var followMessages=defineMessages({input_label:{\"id\":\"export_data.follows_label\",\"defaultMessage\":\"Follows\"},input_hint:{\"id\":\"export_data.hints.follows\",\"defaultMessage\":\"Get a CSV file containing a list of followed accounts\"},submit:{\"id\":\"export_data.actions.export_follows\",\"defaultMessage\":\"Export follows\"}});var blockMessages=defineMessages({input_label:{\"id\":\"export_data.blocks_label\",\"defaultMessage\":\"Blocks\"},input_hint:{\"id\":\"export_data.hints.blocks\",\"defaultMessage\":\"Get a CSV file containing a list of blocked accounts\"},submit:{\"id\":\"export_data.actions.export_blocks\",\"defaultMessage\":\"Export blocks\"}});var muteMessages=defineMessages({input_label:{\"id\":\"export_data.mutes_label\",\"defaultMessage\":\"Mutes\"},input_hint:{\"id\":\"export_data.hints.mutes\",\"defaultMessage\":\"Get a CSV file containing a list of muted accounts\"},submit:{\"id\":\"export_data.actions.export_mutes\",\"defaultMessage\":\"Export mutes\"}});var ExportData=function ExportData(){var intl=useIntl();return/*#__PURE__*/_jsx(Column,{label:intl.formatMessage(messages.heading)},void 0,/*#__PURE__*/_jsx(CSVExporter,{action:exportFollows,messages:followMessages}),/*#__PURE__*/_jsx(CSVExporter,{action:exportBlocks,messages:blockMessages}),/*#__PURE__*/_jsx(CSVExporter,{action:exportMutes,messages:muteMessages}));};export default ExportData;"],"names":["messages","blocksSuccess","followersSuccess","mutesSuccess","fileExport","content","fileName","fileToDownload","document","createElement","setAttribute","encodeURIComponent","style","display","body","appendChild","click","removeChild","listAccounts","getState","_ref","regeneratorRuntime","mark","_callee","apiResponse","followings","accounts","next","wrap","_context","prev","data","refs","find","link","rel","api","get","uri","sent","Array","prototype","push","apply","map","account","fqn","abrupt","from","Set","stop","_x","this","arguments","exportFollows","dispatch","type","me","concat","then","unshift","join","toast","catch","error","exportBlocks","blocks","exportMutes","mutes","action","intl","useIntl","_useState","useState","_useState2","isLoading","setIsLoading","size","weight","formatMessage","input_label","theme","input_hint","onClick","event","disabled","submit","heading","followMessages","blockMessages","muteMessages","label"],"sourceRoot":""}