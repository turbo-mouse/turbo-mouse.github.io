{"version":3,"file":"packs/js/features/announcements-227718873953adc82ddd.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/components/announcements/announcement-content.tsx","webpack://soapbox/./app/soapbox/components/animated-number.tsx","webpack://soapbox/./app/soapbox/components/announcements/emoji.tsx","webpack://soapbox/./app/soapbox/components/announcements/reaction.tsx","webpack://soapbox/./app/soapbox/components/announcements/reactions-bar.tsx","webpack://soapbox/./app/soapbox/components/announcements/announcement.tsx","webpack://soapbox/./app/soapbox/components/announcements/announcements-panel.tsx"],"sourcesContent":["var _this=this;import\"core-js/modules/es.array.push.js\";import\"core-js/modules/es.regexp.exec.js\";import\"core-js/modules/es.string.replace.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/web.dom-collections.for-each.js\";import\"core-js/modules/es.array.find.js\";import React,{useEffect,useRef}from'react';import{useHistory}from'react-router-dom';var AnnouncementContent=function AnnouncementContent(_ref){var announcement=_ref.announcement;var history=useHistory();var node=useRef(null);useEffect(function(){updateLinks();});var onMentionClick=function onMentionClick(mention,e){if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();e.stopPropagation();history.push(\"/@\".concat(mention.acct));}};var onHashtagClick=function onHashtagClick(hashtag,e){hashtag=hashtag.replace(/^#/,'').toLowerCase();if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();e.stopPropagation();history.push(\"/tags/\".concat(hashtag));}};var onStatusClick=function onStatusClick(status,e){if(e.button===0&&!(e.ctrlKey||e.metaKey)){e.preventDefault();history.push(status);}};var updateLinks=function updateLinks(){if(!node.current)return;var links=node.current.querySelectorAll('a');links.forEach(function(link){var _link$textContent,_link$previousSibling,_link$previousSibling2;// Skip already processed\nif(link.classList.contains('status-link'))return;// Add attributes\nlink.classList.add('status-link');link.setAttribute('rel','nofollow noopener');link.setAttribute('target','_blank');var mention=announcement.mentions.find(function(mention){return link.href===\"\".concat(mention.url);});// Add event listeners on mentions, hashtags and statuses\nif(mention){link.addEventListener('click',onMentionClick.bind(link,mention),false);link.setAttribute('title',mention.acct);}else if(((_link$textContent=link.textContent)===null||_link$textContent===void 0?void 0:_link$textContent.charAt(0))==='#'||((_link$previousSibling=link.previousSibling)===null||_link$previousSibling===void 0?void 0:(_link$previousSibling2=_link$previousSibling.textContent)===null||_link$previousSibling2===void 0?void 0:_link$previousSibling2.charAt(link.previousSibling.textContent.length-1))==='#'){link.addEventListener('click',onHashtagClick.bind(link,link.text),false);}else{var status=announcement.statuses.get(link.href);if(status){link.addEventListener('click',onStatusClick.bind(_this,status),false);}link.setAttribute('title',link.href);link.classList.add('unhandled-link');}});};return/*#__PURE__*/React.createElement(\"div\",{className:\"translate text-sm\",ref:node,dangerouslySetInnerHTML:{__html:announcement.contentHtml}});};export default AnnouncementContent;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import\"core-js/modules/es.array.map.js\";import React,{useEffect,useState}from'react';import{FormattedNumber}from'react-intl';import{TransitionMotion,spring}from'react-motion';import{useSettings}from'soapbox/hooks';var obfuscatedCount=function obfuscatedCount(count){if(count<0){return 0;}else if(count<=1){return count;}else{return'1+';}};var AnimatedNumber=function AnimatedNumber(_ref){var value=_ref.value,obfuscate=_ref.obfuscate;var reduceMotion=useSettings().get('reduceMotion');var _useState=useState(1),_useState2=_slicedToArray(_useState,2),direction=_useState2[0],setDirection=_useState2[1];var _useState3=useState(value),_useState4=_slicedToArray(_useState3,2),displayedValue=_useState4[0],setDisplayedValue=_useState4[1];useEffect(function(){if(displayedValue!==undefined){if(value>displayedValue)setDirection(1);else if(value<displayedValue)setDirection(-1);}setDisplayedValue(value);},[value]);var willEnter=function willEnter(){return{y:-1*direction};};var willLeave=function willLeave(){return{y:spring(1*direction,{damping:35,stiffness:400})};};if(reduceMotion){return obfuscate?/*#__PURE__*/React.createElement(React.Fragment,null,obfuscatedCount(displayedValue)):/*#__PURE__*/_jsx(FormattedNumber,{value:displayedValue});}var styles=[{key:\"\".concat(displayedValue),data:displayedValue,style:{y:spring(0,{damping:35,stiffness:400})}}];return/*#__PURE__*/_jsx(TransitionMotion,{styles:styles,willEnter:willEnter,willLeave:willLeave},void 0,function(items){return/*#__PURE__*/_jsx(\"span\",{className:\"relative inline-flex flex-col items-stretch overflow-hidden\"},void 0,items.map(function(_ref2){var key=_ref2.key,data=_ref2.data,style=_ref2.style;return/*#__PURE__*/_jsx(\"span\",{style:{position:direction*style.y>0?'absolute':'static',transform:\"translateY(\".concat(style.y*100,\"%)\")}},key,obfuscate?obfuscatedCount(data):/*#__PURE__*/_jsx(FormattedNumber,{value:data}));}));});};export default AnimatedNumber;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import unicodeMapping from'soapbox/features/emoji/emoji-unicode-mapping-light';import{useSettings}from'soapbox/hooks';import{joinPublicPath}from'soapbox/utils/static';var Emoji=function Emoji(_ref){var emoji=_ref.emoji,emojiMap=_ref.emojiMap,hovered=_ref.hovered;var autoPlayGif=useSettings().get('autoPlayGif');// @ts-ignore\nif(unicodeMapping[emoji]){// @ts-ignore\nvar _unicodeMapping$emoji=unicodeMapping[emoji],filename=_unicodeMapping$emoji.filename,shortCode=_unicodeMapping$emoji.shortCode;var title=shortCode?\":\".concat(shortCode,\":\"):'';return/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"emojione m-0 block\",alt:emoji,title:title,src:joinPublicPath(\"packs/emoji/\".concat(filename,\".svg\"))});}else if(emojiMap.get(emoji)){var _filename=autoPlayGif||hovered?emojiMap.getIn([emoji,'url']):emojiMap.getIn([emoji,'static_url']);var _shortCode=\":\".concat(emoji,\":\");return/*#__PURE__*/_jsx(\"img\",{draggable:\"false\",className:\"emojione m-0 block\",alt:_shortCode,title:_shortCode,src:_filename});}else{return null;}};export default Emoji;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import clsx from'clsx';import React,{useState}from'react';import AnimatedNumber from'soapbox/components/animated-number';import unicodeMapping from'soapbox/features/emoji/emoji-unicode-mapping-light';import Emoji from'./emoji';var Reaction=function Reaction(_ref){var announcementId=_ref.announcementId,reaction=_ref.reaction,addReaction=_ref.addReaction,removeReaction=_ref.removeReaction,emojiMap=_ref.emojiMap,style=_ref.style;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),hovered=_useState2[0],setHovered=_useState2[1];var handleClick=function handleClick(){if(reaction.me){removeReaction(announcementId,reaction.name);}else{addReaction(announcementId,reaction.name);}};var handleMouseEnter=function handleMouseEnter(){return setHovered(true);};var handleMouseLeave=function handleMouseLeave(){return setHovered(false);};var shortCode=reaction.name;// @ts-ignore\nif(unicodeMapping[shortCode]){// @ts-ignore\nshortCode=unicodeMapping[shortCode].shortCode;}return/*#__PURE__*/_jsx(\"button\",{className:clsx('flex shrink-0 items-center gap-1.5 rounded-sm bg-gray-100 px-1.5 py-1 transition-colors dark:bg-primary-900',{'bg-gray-200 dark:bg-primary-800':hovered,'bg-primary-200 dark:bg-primary-500':reaction.me}),onClick:handleClick,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,title:\":\".concat(shortCode,\":\"),style:style},void 0,/*#__PURE__*/_jsx(\"span\",{className:\"block h-4 w-4\"},void 0,/*#__PURE__*/_jsx(Emoji,{hovered:hovered,emoji:reaction.name,emojiMap:emojiMap})),/*#__PURE__*/_jsx(\"span\",{className:\"block min-w-[9px] text-center text-xs font-medium text-primary-600 dark:text-white\"},void 0,/*#__PURE__*/_jsx(AnimatedNumber,{value:reaction.count})));};export default Reaction;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.regexp.exec.js\";import\"core-js/modules/es.string.replace.js\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.promise.js\";import\"core-js/modules/es.array.map.js\";import clsx from'clsx';import React from'react';import{TransitionMotion,spring}from'react-motion';import{Icon}from'soapbox/components/ui';import EmojiPickerDropdown from'soapbox/features/compose/components/emoji-picker/emoji-picker-dropdown';import{useSettings}from'soapbox/hooks';import Reaction from'./reaction';var ReactionsBar=function ReactionsBar(_ref){var announcementId=_ref.announcementId,reactions=_ref.reactions,addReaction=_ref.addReaction,removeReaction=_ref.removeReaction,emojiMap=_ref.emojiMap;var reduceMotion=useSettings().get('reduceMotion');var handleEmojiPick=function handleEmojiPick(data){addReaction(announcementId,data.native.replace(/:/g,''));};var willEnter=function willEnter(){return{scale:reduceMotion?1:0};};var willLeave=function willLeave(){return{scale:reduceMotion?0:spring(0,{stiffness:170,damping:26})};};var visibleReactions=reactions.filter(function(x){return x.count>0;});var styles=visibleReactions.map(function(reaction){return{key:reaction.name,data:reaction,style:{scale:reduceMotion?1:spring(1,{stiffness:150,damping:13})}};}).toArray();return/*#__PURE__*/_jsx(TransitionMotion,{styles:styles,willEnter:willEnter,willLeave:willLeave},void 0,function(items){return/*#__PURE__*/_jsx(\"div\",{className:clsx('flex flex-wrap items-center gap-1',{'reactions-bar--empty':visibleReactions.isEmpty()})},void 0,items.map(function(_ref2){var key=_ref2.key,data=_ref2.data,style=_ref2.style;return/*#__PURE__*/_jsx(Reaction,{reaction:data,style:{transform:\"scale(\".concat(style.scale,\")\"),position:style.scale<0.5?'absolute':'static'},announcementId:announcementId,addReaction:addReaction,removeReaction:removeReaction,emojiMap:emojiMap},key);}),visibleReactions.size<8&&/*#__PURE__*/_jsx(EmojiPickerDropdown,{onPickEmoji:handleEmojiPick,button:/*#__PURE__*/_jsx(Icon,{className:\"h-4 w-4 text-gray-400 hover:text-gray-600 dark:hover:text-white\",src:require('@tabler/icons/plus.svg')})}));});};export default ReactionsBar;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import React from'react';import{FormattedDate}from'react-intl';import{Stack,Text}from'soapbox/components/ui';import{useFeatures}from'soapbox/hooks';import AnnouncementContent from'./announcement-content';import ReactionsBar from'./reactions-bar';var Announcement=function Announcement(_ref){var announcement=_ref.announcement,addReaction=_ref.addReaction,removeReaction=_ref.removeReaction,emojiMap=_ref.emojiMap;var features=useFeatures();var startsAt=announcement.starts_at&&new Date(announcement.starts_at);var endsAt=announcement.ends_at&&new Date(announcement.ends_at);var now=new Date();var hasTimeRange=startsAt&&endsAt;var skipYear=hasTimeRange&&startsAt.getFullYear()===endsAt.getFullYear()&&endsAt.getFullYear()===now.getFullYear();var skipEndDate=hasTimeRange&&startsAt.getDate()===endsAt.getDate()&&startsAt.getMonth()===endsAt.getMonth()&&startsAt.getFullYear()===endsAt.getFullYear();var skipTime=announcement.all_day;return/*#__PURE__*/_jsx(Stack,{className:\"w-full\",space:2},void 0,hasTimeRange&&/*#__PURE__*/_jsx(Text,{theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedDate,{value:startsAt,hour12:true,year:skipYear||startsAt.getFullYear()===now.getFullYear()?undefined:'numeric',month:\"short\",day:\"2-digit\",hour:skipTime?undefined:'numeric',minute:skipTime?undefined:'2-digit'}),' ',\"-\",' ',/*#__PURE__*/_jsx(FormattedDate,{value:endsAt,hour12:true,year:skipYear||endsAt.getFullYear()===now.getFullYear()?undefined:'numeric',month:skipEndDate?undefined:'short',day:skipEndDate?undefined:'2-digit',hour:skipTime?undefined:'numeric',minute:skipTime?undefined:'2-digit'})),/*#__PURE__*/_jsx(AnnouncementContent,{announcement:announcement}),features.announcementsReactions&&/*#__PURE__*/_jsx(ReactionsBar,{reactions:announcement.reactions,announcementId:announcement.id,addReaction:addReaction,removeReaction:removeReaction,emojiMap:emojiMap}));};export default Announcement;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import\"core-js/modules/es.array.reduce.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.array.map.js\";import clsx from'clsx';import{Map as ImmutableMap}from'immutable';import React,{useState}from'react';import{FormattedMessage}from'react-intl';import ReactSwipeableViews from'react-swipeable-views';import{createSelector}from'reselect';import{addReaction as addReactionAction,removeReaction as removeReactionAction}from'soapbox/actions/announcements';import{Card,HStack,Widget}from'soapbox/components/ui';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import Announcement from'./announcement';var customEmojiMap=createSelector([function(state){return state.custom_emojis;}],function(items){return items.reduce(function(map,emoji){return map.set(emoji.get('shortcode'),emoji);},ImmutableMap());});var AnnouncementsPanel=function AnnouncementsPanel(){var dispatch=useAppDispatch();var emojiMap=useAppSelector(function(state){return customEmojiMap(state);});var _useState=useState(0),_useState2=_slicedToArray(_useState,2),index=_useState2[0],setIndex=_useState2[1];var announcements=useAppSelector(function(state){return state.announcements.items;});var addReaction=function addReaction(id,name){return dispatch(addReactionAction(id,name));};var removeReaction=function removeReaction(id,name){return dispatch(removeReactionAction(id,name));};if(announcements.size===0)return null;var handleChangeIndex=function handleChangeIndex(index){setIndex(index%announcements.size);};return/*#__PURE__*/_jsx(Widget,{title:/*#__PURE__*/_jsx(FormattedMessage,{id:\"announcements.title\",defaultMessage:\"Announcements\"})},void 0,/*#__PURE__*/_jsx(Card,{className:\"relative\",size:\"md\",variant:\"rounded\"},void 0,/*#__PURE__*/_jsx(ReactSwipeableViews,{animateHeight:true,index:index,onChangeIndex:handleChangeIndex},void 0,announcements.map(function(announcement){return/*#__PURE__*/_jsx(Announcement,{announcement:announcement,emojiMap:emojiMap,addReaction:addReaction,removeReaction:removeReaction},announcement.id);}).reverse()),announcements.size>1&&/*#__PURE__*/_jsx(HStack,{space:2,alignItems:\"center\",justifyContent:\"center\",className:\"relative\"},void 0,announcements.map(function(_,i){return/*#__PURE__*/_jsx(\"button\",{tabIndex:0,onClick:function onClick(){return setIndex(i);},className:clsx({'w-2 h-2 rounded-full focus:ring-primary-600 focus:ring-2 focus:ring-offset-2':true,'bg-gray-200 hover:bg-gray-300':i!==index,'bg-primary-600':i===index})},i);}))));};export default AnnouncementsPanel;"],"names":["_ref","announcement","history","node","useRef","useEffect","updateLinks","onMentionClick","mention","e","button","ctrlKey","metaKey","preventDefault","stopPropagation","push","concat","acct","onHashtagClick","hashtag","replace","toLowerCase","onStatusClick","status","current","querySelectorAll","forEach","link","_link$textContent","_link$previousSibling","_link$previousSibling2","classList","contains","add","setAttribute","mentions","find","href","url","addEventListener","bind","textContent","charAt","previousSibling","length","text","statuses","get","className","ref","dangerouslySetInnerHTML","__html","contentHtml","obfuscatedCount","count","value","obfuscate","reduceMotion","_useState","useState","_useState2","direction","setDirection","_useState3","_useState4","displayedValue","setDisplayedValue","undefined","styles","key","data","style","y","damping","stiffness","willEnter","willLeave","items","map","_ref2","position","transform","emoji","emojiMap","hovered","autoPlayGif","_unicodeMapping$emoji","filename","shortCode","title","draggable","alt","src","_filename","getIn","_shortCode","announcementId","reaction","addReaction","removeReaction","setHovered","name","me","onClick","onMouseEnter","onMouseLeave","reactions","handleEmojiPick","native","visibleReactions","filter","x","scale","toArray","isEmpty","size","onPickEmoji","features","startsAt","starts_at","Date","endsAt","ends_at","now","hasTimeRange","skipYear","getFullYear","skipEndDate","getDate","getMonth","skipTime","all_day","space","theme","hour12","year","month","day","hour","minute","announcementsReactions","id","customEmojiMap","state","custom_emojis","reduce","set","dispatch","index","setIndex","announcements","defaultMessage","variant","animateHeight","onChangeIndex","reverse","alignItems","justifyContent","_","i","tabIndex"],"sourceRoot":""}