{"version":3,"file":"packs/js/features/compose_event_modal-3483940c079c3d5559b7.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/components/autosuggest-location.tsx","webpack://soapbox/./app/soapbox/components/location-search.tsx","webpack://soapbox/./app/soapbox/features/ui/components/modals/compose-event-modal/upload-button.tsx","webpack://soapbox/./app/soapbox/features/ui/components/modals/compose-event-modal/compose-event-modal.tsx"],"sourcesContent":["import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.symbol.js\";import\"core-js/modules/es.symbol.description.js\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.string.trim.js\";import React from'react';import{useAppSelector}from'soapbox/hooks';import{HStack,Icon,Stack,Text}from'./ui';var buildingCommunityIcon=require('@tabler/icons/building-community.svg');var homeIcon=require('@tabler/icons/home-2.svg');var mapPinIcon=require('@tabler/icons/map-pin.svg');var roadIcon=require('@tabler/icons/road.svg');export var ADDRESS_ICONS={house:homeIcon,street:roadIcon,secondary:roadIcon,zone:buildingCommunityIcon,city:buildingCommunityIcon,administrative:buildingCommunityIcon};var AutosuggestLocation=function AutosuggestLocation(_ref){var id=_ref.id;var location=useAppSelector(function(state){return state.locations.get(id);});if(!location)return null;return/*#__PURE__*/_jsx(HStack,{alignItems:\"center\",space:2},void 0,/*#__PURE__*/_jsx(Icon,{src:ADDRESS_ICONS[location.type]||mapPinIcon}),/*#__PURE__*/_jsx(Stack,{},void 0,/*#__PURE__*/_jsx(Text,{},void 0,location.description),/*#__PURE__*/_jsx(Text,{size:\"xs\",theme:\"muted\"},void 0,[location.street,location.locality,location.country].filter(function(val){return val===null||val===void 0?void 0:val.trim();}).join(' · '))));};export default AutosuggestLocation;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import\"core-js/modules/es.array.map.js\";import clsx from'clsx';import{OrderedSet as ImmutableOrderedSet}from'immutable';import throttle from'lodash/throttle';import React,{useCallback,useEffect,useRef,useState}from'react';import{defineMessages,useIntl}from'react-intl';import{locationSearch}from'soapbox/actions/events';import AutosuggestInput from'soapbox/components/autosuggest-input';import Icon from'soapbox/components/icon';import{useAppDispatch}from'soapbox/hooks';import AutosuggestLocation from'./autosuggest-location';var noOp=function noOp(){};var messages=defineMessages({placeholder:{\"id\":\"location_search.placeholder\",\"defaultMessage\":\"Find an address\"}});var LocationSearch=function LocationSearch(_ref){var onSelected=_ref.onSelected;var intl=useIntl();var dispatch=useAppDispatch();var _useState=useState(ImmutableOrderedSet()),_useState2=_slicedToArray(_useState,2),locationIds=_useState2[0],setLocationIds=_useState2[1];var controller=useRef(new AbortController());var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),value=_useState4[0],setValue=_useState4[1];var isEmpty=function isEmpty(){return!(value.length>0);};var handleChange=function handleChange(_ref2){var target=_ref2.target;refreshCancelToken();handleLocationSearch(target.value);setValue(target.value);};var handleSelected=function handleSelected(_tokenStart,_lastToken,suggestion){if(typeof suggestion==='string'){onSelected(suggestion);}};var handleClear=function handleClear(e){e.preventDefault();if(!isEmpty()){setValue('');}};var handleKeyDown=function handleKeyDown(e){if(e.key==='Escape'){var _document$querySelect,_document$querySelect2;(_document$querySelect=document.querySelector('.ui'))===null||_document$querySelect===void 0?void 0:(_document$querySelect2=_document$querySelect.parentElement)===null||_document$querySelect2===void 0?void 0:_document$querySelect2.focus();}};var refreshCancelToken=function refreshCancelToken(){controller.current.abort();controller.current=new AbortController();};var clearResults=function clearResults(){setLocationIds(ImmutableOrderedSet());};var handleLocationSearch=useCallback(throttle(function(q){dispatch(locationSearch(q,controller.current.signal)).then(function(locations){var locationIds=locations.map(function(location){return location.origin_id;});setLocationIds(ImmutableOrderedSet(locationIds));}).catch(noOp);},900,{leading:true,trailing:true}),[]);useEffect(function(){if(value===''){clearResults();}},[value]);return/*#__PURE__*/_jsx(\"div\",{className:\"search\"},void 0,/*#__PURE__*/_jsx(AutosuggestInput,{className:\"rounded-full\",placeholder:intl.formatMessage(messages.placeholder),value:value,onChange:handleChange,suggestions:locationIds.toList(),onSuggestionsFetchRequested:noOp,onSuggestionsClearRequested:noOp,onSuggestionSelected:handleSelected,searchTokens:[],onKeyDown:handleKeyDown,renderSuggestion:AutosuggestLocation}),/*#__PURE__*/_jsx(\"div\",{role:\"button\",tabIndex:0,className:\"search__icon\",onClick:handleClear},void 0,/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/search.svg'),className:clsx('svg-icon--search',{active:isEmpty()})}),/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/backspace.svg'),className:clsx('svg-icon--backspace',{active:!isEmpty()}),\"aria-label\":intl.formatMessage(messages.placeholder)})));};export default LocationSearch;","import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.string.starts-with.js\";import\"core-js/modules/es.promise.js\";import React,{useRef}from'react';import{FormattedMessage}from'react-intl';import Icon from'soapbox/components/icon';import{HStack,Text}from'soapbox/components/ui';import{useAppSelector}from'soapbox/hooks';var UploadButton=function UploadButton(_ref){var _useAppSelector;var disabled=_ref.disabled,onSelectFile=_ref.onSelectFile;var fileElement=useRef(null);var attachmentTypes=(_useAppSelector=useAppSelector(function(state){return state.instance.configuration.getIn(['media_attachments','supported_mime_types']);}))===null||_useAppSelector===void 0?void 0:_useAppSelector.filter(function(type){return type.startsWith('image/');});var handleChange=function handleChange(e){var _e$target$files;if((_e$target$files=e.target.files)!==null&&_e$target$files!==void 0&&_e$target$files.length){onSelectFile(e.target.files);}};var handleClick=function handleClick(){var _fileElement$current;(_fileElement$current=fileElement.current)===null||_fileElement$current===void 0?void 0:_fileElement$current.click();};return/*#__PURE__*/_jsx(HStack,{className:\"h-full w-full cursor-pointer text-primary-500 dark:text-accent-blue\",space:3,alignItems:\"center\",justifyContent:\"center\",element:\"label\"},void 0,/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/photo-plus.svg'),className:\"h-7 w-7\",onClick:handleClick}),/*#__PURE__*/_jsx(Text,{size:\"sm\",theme:\"primary\",weight:\"semibold\",transform:\"uppercase\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.upload_banner\",defaultMessage:\"Upload photo\"})),/*#__PURE__*/React.createElement(\"input\",{ref:fileElement,type:\"file\",accept:attachmentTypes&&attachmentTypes.toArray().join(','),onChange:handleChange,disabled:disabled,className:\"hidden\"}));};export default UploadButton;","import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.symbol.js\";import\"core-js/modules/es.symbol.description.js\";import\"core-js/modules/es.array.filter.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.string.trim.js\";import\"core-js/modules/es.array.map.js\";import React,{useEffect,useState}from'react';import{defineMessages,FormattedMessage,useIntl}from'react-intl';import Toggle from'react-toggle';import{changeEditEventApprovalRequired,changeEditEventDescription,changeEditEventEndTime,changeEditEventHasEndTime,changeEditEventName,changeEditEventStartTime,changeEditEventLocation,uploadEventBanner,undoUploadEventBanner,submitEvent,fetchEventParticipationRequests,rejectEventParticipationRequest,authorizeEventParticipationRequest,cancelEventCompose}from'soapbox/actions/events';import{closeModal,openModal}from'soapbox/actions/modals';import{ADDRESS_ICONS}from'soapbox/components/autosuggest-location';import LocationSearch from'soapbox/components/location-search';import{checkEventComposeContent}from'soapbox/components/modal-root';import{Button,Form,FormGroup,HStack,Icon,IconButton,Input,Modal,Spinner,Stack,Tabs,Text,Textarea}from'soapbox/components/ui';import AccountContainer from'soapbox/containers/account-container';import{isCurrentOrFutureDate}from'soapbox/features/compose/components/schedule-form';import BundleContainer from'soapbox/features/ui/containers/bundle-container';import{DatePicker}from'soapbox/features/ui/util/async-components';import{useAppDispatch,useAppSelector}from'soapbox/hooks';import UploadButton from'./upload-button';var messages=defineMessages({eventNamePlaceholder:{\"id\":\"compose_event.fields.name_placeholder\",\"defaultMessage\":\"Name\"},eventDescriptionPlaceholder:{\"id\":\"compose_event.fields.description_placeholder\",\"defaultMessage\":\"Description\"},eventStartTimePlaceholder:{\"id\":\"compose_event.fields.start_time_placeholder\",\"defaultMessage\":\"Event begins on\\u2026\"},eventEndTimePlaceholder:{\"id\":\"compose_event.fields.end_time_placeholder\",\"defaultMessage\":\"Event ends on\\u2026\"},resetLocation:{\"id\":\"compose_event.reset_location\",\"defaultMessage\":\"Reset location\"},edit:{\"id\":\"compose_event.tabs.edit\",\"defaultMessage\":\"Edit details\"},pending:{\"id\":\"compose_event.tabs.pending\",\"defaultMessage\":\"Manage requests\"},authorize:{\"id\":\"compose_event.participation_requests.authorize\",\"defaultMessage\":\"Authorize\"},reject:{\"id\":\"compose_event.participation_requests.reject\",\"defaultMessage\":\"Reject\"},confirm:{\"id\":\"confirmations.delete.confirm\",\"defaultMessage\":\"Delete\"},cancelEditing:{\"id\":\"confirmations.cancel_editing.confirm\",\"defaultMessage\":\"Cancel editing\"}});var Account=function Account(_ref){var eventId=_ref.eventId,id=_ref.id,participationMessage=_ref.participationMessage;var intl=useIntl();var dispatch=useAppDispatch();var handleAuthorize=function handleAuthorize(){dispatch(authorizeEventParticipationRequest(eventId,id));};var handleReject=function handleReject(){dispatch(rejectEventParticipationRequest(eventId,id));};return/*#__PURE__*/_jsx(AccountContainer,{id:id,note:participationMessage||undefined,action:/*#__PURE__*/_jsx(HStack,{space:2},void 0,/*#__PURE__*/_jsx(Button,{theme:\"secondary\",size:\"sm\",text:intl.formatMessage(messages.authorize),onClick:handleAuthorize}),/*#__PURE__*/_jsx(Button,{theme:\"danger\",size:\"sm\",text:intl.formatMessage(messages.reject),onClick:handleReject}))});};var ComposeEventModal=function ComposeEventModal(_ref2){var onClose=_ref2.onClose;var intl=useIntl();var dispatch=useAppDispatch();var _useState=useState('edit'),_useState2=_slicedToArray(_useState,2),tab=_useState2[0],setTab=_useState2[1];var banner=useAppSelector(function(state){return state.compose_event.banner;});var isUploading=useAppSelector(function(state){return state.compose_event.is_uploading;});var name=useAppSelector(function(state){return state.compose_event.name;});var description=useAppSelector(function(state){return state.compose_event.status;});var startTime=useAppSelector(function(state){return state.compose_event.start_time;});var endTime=useAppSelector(function(state){return state.compose_event.end_time;});var approvalRequired=useAppSelector(function(state){return state.compose_event.approval_required;});var location=useAppSelector(function(state){return state.compose_event.location;});var id=useAppSelector(function(state){return state.compose_event.id;});var isSubmitting=useAppSelector(function(state){return state.compose_event.is_submitting;});var onChangeName=function onChangeName(_ref3){var target=_ref3.target;dispatch(changeEditEventName(target.value));};var onChangeDescription=function onChangeDescription(_ref4){var target=_ref4.target;dispatch(changeEditEventDescription(target.value));};var onChangeStartTime=function onChangeStartTime(date){dispatch(changeEditEventStartTime(date));};var onChangeEndTime=function onChangeEndTime(date){dispatch(changeEditEventEndTime(date));};var onChangeHasEndTime=function onChangeHasEndTime(_ref5){var target=_ref5.target;dispatch(changeEditEventHasEndTime(target.checked));};var onChangeApprovalRequired=function onChangeApprovalRequired(_ref6){var target=_ref6.target;dispatch(changeEditEventApprovalRequired(target.checked));};var onChangeLocation=function onChangeLocation(value){dispatch(changeEditEventLocation(value));};var onClickClose=function onClickClose(){dispatch(function(dispatch,getState){if(checkEventComposeContent(getState().compose_event)){dispatch(openModal('CONFIRM',{icon:require('@tabler/icons/trash.svg'),heading:id?/*#__PURE__*/_jsx(FormattedMessage,{id:\"confirmations.cancel_event_editing.heading\",defaultMessage:\"Cancel event editing\"}):/*#__PURE__*/_jsx(FormattedMessage,{id:\"confirmations.delete_event.heading\",defaultMessage:\"Delete event\"}),message:id?/*#__PURE__*/_jsx(FormattedMessage,{id:\"confirmations.cancel_event_editing.message\",defaultMessage:\"Are you sure you want to cancel editing this event? All changes will be lost.\"}):/*#__PURE__*/_jsx(FormattedMessage,{id:\"confirmations.delete_event.message\",defaultMessage:\"Are you sure you want to delete this event?\"}),confirm:intl.formatMessage(messages.confirm),onConfirm:function onConfirm(){dispatch(closeModal('COMPOSE_EVENT'));dispatch(cancelEventCompose());}}));}else{onClose('COMPOSE_EVENT');}});};var handleFiles=function handleFiles(files){dispatch(uploadEventBanner(files[0],intl));};var handleClearBanner=function handleClearBanner(){dispatch(undoUploadEventBanner());};var handleSubmit=function handleSubmit(){dispatch(submitEvent());};var accounts=useAppSelector(function(state){var _state$user_lists$eve;return(_state$user_lists$eve=state.user_lists.event_participation_requests.get(id))===null||_state$user_lists$eve===void 0?void 0:_state$user_lists$eve.items;});useEffect(function(){if(id)dispatch(fetchEventParticipationRequests(id));},[]);var renderLocation=function renderLocation(){return location&&/*#__PURE__*/_jsx(HStack,{className:\"h-[38px] text-gray-700 dark:text-gray-500\",alignItems:\"center\",space:2},void 0,/*#__PURE__*/_jsx(Icon,{src:ADDRESS_ICONS[location.type]||require('@tabler/icons/map-pin.svg')}),/*#__PURE__*/_jsx(Stack,{className:\"grow\"},void 0,/*#__PURE__*/_jsx(Text,{},void 0,location.description),/*#__PURE__*/_jsx(Text,{theme:\"muted\",size:\"xs\"},void 0,[location.street,location.locality,location.country].filter(function(val){return val.trim();}).join(' · '))),/*#__PURE__*/_jsx(IconButton,{title:intl.formatMessage(messages.resetLocation),src:require('@tabler/icons/x.svg'),onClick:function onClick(){return onChangeLocation(null);}}));};var renderTabs=function renderTabs(){var items=[{text:intl.formatMessage(messages.edit),action:function action(){return setTab('edit');},name:'edit'},{text:intl.formatMessage(messages.pending),action:function action(){return setTab('pending');},name:'pending'}];return/*#__PURE__*/_jsx(Tabs,{items:items,activeItem:tab});};var body;if(tab==='edit')body=/*#__PURE__*/_jsx(Form,{},void 0,/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.banner_label\",defaultMessage:\"Event banner\"})},void 0,/*#__PURE__*/_jsx(\"div\",{className:\"dark:sm:shadow-inset relative flex h-24 items-center justify-center overflow-hidden rounded-lg bg-primary-100 text-primary-500 dark:bg-gray-800 dark:text-white sm:h-32 sm:shadow\"},void 0,banner?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/_jsx(\"img\",{className:\"h-full w-full object-cover\",src:banner.url,alt:\"\"}),/*#__PURE__*/_jsx(IconButton,{className:\"absolute top-2 right-2\",src:require('@tabler/icons/x.svg'),onClick:handleClearBanner})):/*#__PURE__*/_jsx(UploadButton,{disabled:isUploading,onSelectFile:handleFiles}))),/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.name_label\",defaultMessage:\"Event name\"})},void 0,/*#__PURE__*/_jsx(Input,{type:\"text\",placeholder:intl.formatMessage(messages.eventNamePlaceholder),value:name,onChange:onChangeName})),/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.description_label\",defaultMessage:\"Event description\"}),hintText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.description_hint\",defaultMessage:\"Markdown syntax is supported\"})},void 0,/*#__PURE__*/_jsx(Textarea,{autoComplete:\"off\",placeholder:intl.formatMessage(messages.eventDescriptionPlaceholder),value:description,onChange:onChangeDescription})),/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.location_label\",defaultMessage:\"Event location\"})},void 0,location?renderLocation():/*#__PURE__*/_jsx(LocationSearch,{onSelected:onChangeLocation})),/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.start_time_label\",defaultMessage:\"Event start date\"})},void 0,/*#__PURE__*/_jsx(BundleContainer,{fetchComponent:DatePicker},void 0,function(Component){return/*#__PURE__*/_jsx(Component,{showTimeSelect:true,dateFormat:\"MMMM d, yyyy h:mm aa\",timeIntervals:15,wrapperClassName:\"react-datepicker-wrapper\",placeholderText:intl.formatMessage(messages.eventStartTimePlaceholder),filterDate:isCurrentOrFutureDate,selected:startTime,onChange:onChangeStartTime});})),/*#__PURE__*/_jsx(HStack,{alignItems:\"center\",space:2},void 0,/*#__PURE__*/_jsx(Toggle,{icons:false,checked:!!endTime,onChange:onChangeHasEndTime}),/*#__PURE__*/_jsx(Text,{tag:\"span\",theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.has_end_time\",defaultMessage:\"The event has end date\"}))),endTime&&/*#__PURE__*/_jsx(FormGroup,{labelText:/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.end_time_label\",defaultMessage:\"Event end date\"})},void 0,/*#__PURE__*/_jsx(BundleContainer,{fetchComponent:DatePicker},void 0,function(Component){return/*#__PURE__*/_jsx(Component,{showTimeSelect:true,dateFormat:\"MMMM d, yyyy h:mm aa\",timeIntervals:15,wrapperClassName:\"react-datepicker-wrapper\",placeholderText:intl.formatMessage(messages.eventEndTimePlaceholder),filterDate:isCurrentOrFutureDate,selected:endTime,onChange:onChangeEndTime});})),!id&&/*#__PURE__*/_jsx(HStack,{alignItems:\"center\",space:2},void 0,/*#__PURE__*/_jsx(Toggle,{icons:false,checked:approvalRequired,onChange:onChangeApprovalRequired}),/*#__PURE__*/_jsx(Text,{tag:\"span\",theme:\"muted\"},void 0,/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.fields.approval_required\",defaultMessage:\"I want to approve participation requests manually\"}))));else body=accounts?/*#__PURE__*/_jsx(Stack,{space:3},void 0,accounts.size>0?accounts.map(function(_ref7){var account=_ref7.account,participation_message=_ref7.participation_message;return/*#__PURE__*/_jsx(Account,{eventId:id,id:account,participationMessage:participation_message},account);}):/*#__PURE__*/_jsx(FormattedMessage,{id:\"empty_column.event_participant_requests\",defaultMessage:\"There are no pending event participation requests.\"})):/*#__PURE__*/_jsx(Spinner,{});return/*#__PURE__*/_jsx(Modal,{title:id?/*#__PURE__*/_jsx(FormattedMessage,{id:\"navigation_bar.compose_event\",defaultMessage:\"Manage event\"}):/*#__PURE__*/_jsx(FormattedMessage,{id:\"navigation_bar.create_event\",defaultMessage:\"Create new event\"}),confirmationAction:tab==='edit'?handleSubmit:undefined,confirmationText:id?/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.update\",defaultMessage:\"Update\"}):/*#__PURE__*/_jsx(FormattedMessage,{id:\"compose_event.create\",defaultMessage:\"Create\"}),confirmationDisabled:isSubmitting,onClose:onClickClose},void 0,/*#__PURE__*/_jsx(Stack,{space:2},void 0,id&&renderTabs(),body));};export default ComposeEventModal;"],"names":["buildingCommunityIcon","homeIcon","mapPinIcon","roadIcon","ADDRESS_ICONS","house","street","secondary","zone","city","administrative","_ref","id","location","state","locations","get","alignItems","space","src","type","description","size","theme","locality","country","filter","val","trim","join","noOp","messages","placeholder","onSelected","intl","useIntl","dispatch","_useState","useState","_useState2","locationIds","setLocationIds","controller","useRef","AbortController","_useState3","_useState4","value","setValue","isEmpty","length","handleLocationSearch","useCallback","q","current","signal","then","map","origin_id","catch","leading","trailing","useEffect","className","formatMessage","onChange","_ref2","target","abort","suggestions","toList","onSuggestionsFetchRequested","onSuggestionsClearRequested","onSuggestionSelected","_tokenStart","_lastToken","suggestion","searchTokens","onKeyDown","e","_document$querySelect","_document$querySelect2","key","document","querySelector","parentElement","focus","renderSuggestion","role","tabIndex","onClick","preventDefault","active","_useAppSelector","disabled","onSelectFile","fileElement","attachmentTypes","instance","configuration","getIn","startsWith","justifyContent","element","_fileElement$current","click","weight","transform","defaultMessage","ref","accept","toArray","_e$target$files","files","eventNamePlaceholder","eventDescriptionPlaceholder","eventStartTimePlaceholder","eventEndTimePlaceholder","resetLocation","edit","pending","authorize","reject","confirm","cancelEditing","Account","eventId","participationMessage","note","undefined","action","text","body","items","onClose","tab","setTab","banner","compose_event","isUploading","is_uploading","name","status","startTime","start_time","endTime","end_time","approvalRequired","approval_required","isSubmitting","is_submitting","onChangeStartTime","date","onChangeEndTime","onChangeLocation","accounts","_state$user_lists$eve","user_lists","event_participation_requests","labelText","url","alt","_ref3","hintText","autoComplete","_ref4","title","fetchComponent","Component","showTimeSelect","dateFormat","timeIntervals","wrapperClassName","placeholderText","filterDate","isCurrentOrFutureDate","selected","icons","checked","_ref5","tag","_ref6","_ref7","account","participation_message","confirmationAction","confirmationText","confirmationDisabled","getState","icon","heading","message","onConfirm","activeItem"],"sourceRoot":""}