"use strict";(self.webpackChunksoapbox=self.webpackChunksoapbox||[]).push([[35],{1399:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}}),a(12),a(13),a(10),a(20),a(8),a(22),a(23),a(9);var i=a(2053),l=a(2063),o=a(2047),s=a(2049),d=(a(4),a(14),a(0),a(25),a(17),a(16),a(7),a(60),a(91),a(66),a(935)),r=a(1),n=a(2064),c=a(2065),f=a(2083),u=a(46),h=a(140),p=a(2087),_=a(98),g=a(2),Z=a(3),b=a(56),v=a(36),m=a(289),w=a(203),y=a(166),M=function(e){var t=e.account,a=(0,Z.Dn)().displayFqn;return(0,l.Z)("div",{className:"dark:sm:shadow-inset overflow-hidden rounded-lg bg-white text-black dark:bg-gray-800 dark:text-white sm:shadow"},void 0,(0,l.Z)("div",{className:"relative isolate h-32 w-full overflow-hidden bg-gray-200 dark:bg-gray-900/50 md:rounded-t-lg"},void 0,(0,l.Z)(w.Z,{src:t.header})),(0,l.Z)(g.Ug,{space:3,alignItems:"center",className:"p-3"},void 0,(0,l.Z)("div",{className:"relative"},void 0,(0,l.Z)(g.qE,{className:"bg-gray-400",src:t.avatar}),t.verified&&(0,l.Z)("div",{className:"absolute -top-1.5 -right-1.5"},void 0,(0,l.Z)(y.Z,{}))),(0,l.Z)(g.Kq,{className:"truncate"},void 0,(0,l.Z)(g.xv,{weight:"medium",size:"sm",truncate:!0,dangerouslySetInnerHTML:{__html:t.display_name_html}}),(0,l.Z)(g.xv,{theme:"muted",size:"sm"},void 0,"@",a?t.fqn:t.acct))))};function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,o.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var C=(0,n.vU)({heading:{id:"column.edit_profile",defaultMessage:"Edit profile"},header:{id:"edit_profile.header",defaultMessage:"Edit Profile"},metaFieldLabel:{id:"edit_profile.fields.meta_fields.label_placeholder",defaultMessage:"Label"},metaFieldContent:{id:"edit_profile.fields.meta_fields.content_placeholder",defaultMessage:"Content"},success:{id:"edit_profile.success",defaultMessage:"Profile saved!"},error:{id:"edit_profile.error",defaultMessage:"Profile update failed"},bioPlaceholder:{id:"edit_profile.fields.bio_placeholder",defaultMessage:"Tell us about yourself."},displayNamePlaceholder:{id:"edit_profile.fields.display_name_placeholder",defaultMessage:"Name"},websitePlaceholder:{id:"edit_profile.fields.website_placeholder",defaultMessage:"Display a Link"},locationPlaceholder:{id:"edit_profile.fields.location_placeholder",defaultMessage:"Location"},cancel:{id:"common.cancel",defaultMessage:"Cancel"}}),P=function(e){var t=e.value,a=e.onChange,i=(0,c.Z)(),s=function(e){return function(i){a(x(x({},t),{},(0,o.Z)({},e,i.currentTarget.value)))}};return(0,l.Z)(g.Ug,{space:2,grow:!0},void 0,(0,l.Z)(g.II,{type:"text",outerClassName:"w-2/5 grow",value:t.name,onChange:s("name"),placeholder:i.formatMessage(C.metaFieldLabel)}),(0,l.Z)(g.II,{type:"text",outerClassName:"w-3/5 grow",value:t.value,onChange:s("value"),placeholder:i.formatMessage(C.metaFieldContent)}))},I=function(){var e=(0,c.Z)(),t=(0,Z.TL)(),a=(0,Z.fz)(),n=(0,Z.Tr)(),w=(0,Z.hz)(),y=a.pleroma.getIn(["metadata","fields_limits","max_fields"],4),k=(0,r.useState)(!1),I=(0,i.Z)(k,2),O=I[0],N=I[1],T=(0,r.useState)({}),D=(0,i.Z)(T,2),L=D[0],S=D[1],j=(0,r.useState)(!1),z=(0,i.Z)(j,2),F=z[0],H=z[1];(0,r.useEffect)((function(){if(n){var e=function(e){var t=function(e){var t=e.pleroma.toJS(),a=t.hide_followers,i=t.hide_follows,l=t.hide_followers_count,o=t.hide_follows_count;return Boolean(a&&i&&l&&o)}(e);return{discoverable:e.discoverable,bot:e.bot,display_name:e.display_name,note:e.source.get("note"),locked:e.locked,fields_attributes:(0,s.Z)(e.source.get("fields",(0,d.List)()).toJS()),stranger_notifications:!0===e.getIn(["pleroma","notification_settings","block_from_strangers"]),accepts_email_list:!0===e.getIn(["pleroma","accepts_email_list"]),hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t,website:e.website,location:e.location,birthday:e.birthday}}(n),t=!0===n.getIn(["pleroma","notification_settings","block_from_strangers"]);S(e),H(t)}}),[null==n?void 0:n.id]);var U=function(e,t){S((function(a){return x(x({},a),{},(0,o.Z)({},e,t))}))},E=function(e){return function(t){U(e,t.target.checked)}},R=function(e){return function(t){U(e,t.target.value)}},q=function(e,t){return function(a){var i,l=null===(i=a.target.files)||void 0===i?void 0:i.item(0);l&&(0,m.Z)(l,t).then((function(t){U(e,t)})).catch(console.error)}},G=(0,r.useMemo)((function(){return L.avatar?URL.createObjectURL(L.avatar):null==n?void 0:n.avatar}),[L.avatar,null==n?void 0:n.avatar]),W=(0,r.useMemo)((function(){return L.header?URL.createObjectURL(L.header):null==n?void 0:n.header}),[L.header,null==n?void 0:n.header]),B=(0,r.useMemo)((function(){return(0,b.WT)(x(x(x({},null==n?void 0:n.toJS()),L),{},{avatar:G,header:W}))}),[null==n?void 0:n.id,L.display_name,G,W]);return(0,l.Z)(g.sg,{label:e.formatMessage(C.header)},void 0,(0,l.Z)(g.l0,{onSubmit:function(a){var i,l=[],o=x({},L);0===(null===(i=o.fields_attributes)||void 0===i?void 0:i.length)&&(o.fields_attributes=[{name:"",value:""}]),l.push(t((0,h.sQ)(o,!0))),w.muteStrangers&&l.push(t((0,u.lUE)({block_from_strangers:F})).catch(console.error)),N(!0),Promise.all(l).then((function(){N(!1),v.Z.success(e.formatMessage(C.success))})).catch((function(){N(!1),v.Z.error(e.formatMessage(C.error))})),a.preventDefault()}},void 0,(0,l.Z)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2"},void 0,(0,l.Z)(M,{account:B}),(0,l.Z)("div",{className:"space-y-4"},void 0,(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.header_label",defaultMessage:"Choose Background Picture"}),hintText:(0,l.Z)(f.Z,{id:"edit_profile.hints.header",defaultMessage:"PNG, GIF or JPG. Will be downscaled to {size}",values:{size:"1920x1080px"}})},void 0,(0,l.Z)(g.S2,{onChange:q("header",2073600)})),(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.avatar_label",defaultMessage:"Choose Profile Picture"}),hintText:(0,l.Z)(f.Z,{id:"edit_profile.hints.avatar",defaultMessage:"PNG, GIF or JPG. Will be downscaled to {size}",values:{size:"400x400px"}})},void 0,(0,l.Z)(g.S2,{onChange:q("avatar",16e4)})))),(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.display_name_label",defaultMessage:"Display name"})},void 0,(0,l.Z)(g.II,{type:"text",value:L.display_name,onChange:R("display_name"),placeholder:e.formatMessage(C.displayNamePlaceholder)})),w.birthdays&&(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.birthday_label",defaultMessage:"Birthday"})},void 0,(0,l.Z)(p.Z,{value:L.birthday,onChange:function(e){U("birthday",e)}})),w.accountLocation&&(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.location_label",defaultMessage:"Location"})},void 0,(0,l.Z)(g.II,{type:"text",value:L.location,onChange:R("location"),placeholder:e.formatMessage(C.locationPlaceholder)})),w.accountWebsite&&(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.website_label",defaultMessage:"Website"})},void 0,(0,l.Z)(g.II,{type:"text",value:L.website,onChange:R("website"),placeholder:e.formatMessage(C.websitePlaceholder)})),(0,l.Z)(g.cw,{labelText:(0,l.Z)(f.Z,{id:"edit_profile.fields.bio_label",defaultMessage:"Bio"})},void 0,(0,l.Z)(g.gx,{value:L.note,onChange:R("note"),autoComplete:"off",placeholder:e.formatMessage(C.bioPlaceholder)})),(0,l.Z)(_.Z,{},void 0,w.followRequests&&(0,l.Z)(_.H,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.locked_label",defaultMessage:"Lock account"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.locked",defaultMessage:"Requires you to manually approve followers"})},void 0,(0,l.Z)(g.ZD,{checked:L.locked,onChange:E("locked")})),w.hideNetwork&&(0,l.Z)(_.H,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.hide_network_label",defaultMessage:"Hide network"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.hide_network",defaultMessage:"Who you follow and who follows you will not be shown on your profile"})},void 0,(0,l.Z)(g.ZD,{checked:!!n&&L.hide_followers&&L.hide_follows&&L.hide_followers_count&&L.hide_follows_count,onChange:function(e){var t=e.target.checked;S((function(e){return x(x({},e),{},{hide_followers:t,hide_follows:t,hide_followers_count:t,hide_follows_count:t})}))}})),w.bots&&(0,l.Z)(_.H,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.bot_label",defaultMessage:"This is a bot account"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.bot",defaultMessage:"This account mainly performs automated actions and might not be monitored"})},void 0,(0,l.Z)(g.ZD,{checked:L.bot,onChange:E("bot")})),w.muteStrangers&&(0,l.Z)(_.H,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.stranger_notifications_label",defaultMessage:"Block notifications from strangers"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.stranger_notifications",defaultMessage:"Only show notifications from people you follow"})},void 0,(0,l.Z)(g.ZD,{checked:F,onChange:function(e){return H(e.target.checked)}})),w.profileDirectory&&(0,l.Z)(_.H,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.discoverable_label",defaultMessage:"Allow account discovery"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.discoverable",defaultMessage:"Display account in profile directory and allow indexing by external services"})},void 0,(0,l.Z)(g.ZD,{checked:L.discoverable,onChange:E("discoverable")})),w.emailList&&(0,l.Z)(_.H,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.accepts_email_list_label",defaultMessage:"Subscribe to newsletter"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.accepts_email_list",defaultMessage:"Opt-in to news and marketing updates."})},void 0,(0,l.Z)(g.ZD,{checked:L.accepts_email_list,onChange:E("accepts_email_list")}))),w.profileFields&&(0,l.Z)(g.uc,{label:(0,l.Z)(f.Z,{id:"edit_profile.fields.meta_fields_label",defaultMessage:"Profile fields"}),hint:(0,l.Z)(f.Z,{id:"edit_profile.hints.meta_fields",defaultMessage:"You can have up to {count, plural, one {# custom field} other {# custom fields}} displayed on your profile.",values:{count:y}}),values:L.fields_attributes||[],onChange:function(e){U("fields_attributes",e)},onAddItem:function(){var e=L.fields_attributes||[],t=[].concat((0,s.Z)(e),[{name:"",value:""}]);U("fields_attributes",t)},onRemoveItem:function(e){var t=L.fields_attributes||[],a=(0,s.Z)(t);a.splice(e,1),U("fields_attributes",a)},component:P,maxItems:y}),(0,l.Z)(g.iN,{},void 0,(0,l.Z)(g.zx,{to:"/settings",theme:"tertiary"},void 0,e.formatMessage(C.cancel)),(0,l.Z)(g.zx,{theme:"primary",type:"submit",disabled:O},void 0,(0,l.Z)(f.Z,{id:"edit_profile.save",defaultMessage:"Save"})))))}}}]);
//# sourceMappingURL=edit_profile-b227364c2974d4b570dd.chunk.js.map