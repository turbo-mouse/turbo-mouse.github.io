{"version":3,"file":"packs/js/status/media_gallery-2d67ea5bd148eaa4397b.chunk.js","mappings":"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","sources":["webpack://soapbox/./app/soapbox/components/media-gallery.tsx"],"sourcesContent":["import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";import _extends from\"@babel/runtime/helpers/esm/extends\";import _jsx from\"@babel/runtime/helpers/esm/jsx\";import\"core-js/modules/es.symbol.js\";import\"core-js/modules/es.symbol.description.js\";import\"core-js/modules/es.array.map.js\";import\"core-js/modules/es.array.fill.js\";import\"core-js/modules/es.object.to-string.js\";import\"core-js/modules/es.promise.js\";import clsx from'clsx';import React,{useState,useRef,useLayoutEffect}from'react';import Blurhash from'soapbox/components/blurhash';import Icon from'soapbox/components/icon';import StillImage from'soapbox/components/still-image';import{MIMETYPE_ICONS}from'soapbox/components/upload';import{useSettings,useSoapboxConfig}from'soapbox/hooks';import{truncateFilename}from'soapbox/utils/media';import{isIOS}from'../is-mobile';import{isPanoramic,isPortrait,isNonConformingRatio,minimumAspectRatio,maximumAspectRatio}from'../utils/media-aspect-ratio';var ATTACHMENT_LIMIT=4;var MAX_FILENAME_LENGTH=45;var withinLimits=function withinLimits(aspectRatio){return aspectRatio>=minimumAspectRatio&&aspectRatio<=maximumAspectRatio;};var shouldLetterbox=function shouldLetterbox(attachment){var aspectRatio=attachment.getIn(['meta','original','aspect']);if(!aspectRatio)return true;return!withinLimits(aspectRatio);};var Item=function Item(_ref){var attachment=_ref.attachment,index=_ref.index,onClick=_ref.onClick,_ref$standalone=_ref.standalone,standalone=_ref$standalone===void 0?false:_ref$standalone,visible=_ref.visible,dimensions=_ref.dimensions,last=_ref.last,total=_ref.total;var settings=useSettings();var autoPlayGif=settings.get('autoPlayGif')===true;var _useSoapboxConfig=useSoapboxConfig(),mediaPreview=_useSoapboxConfig.mediaPreview;var handleMouseEnter=function handleMouseEnter(_ref2){var video=_ref2.currentTarget;if(hoverToPlay()){video.play();}};var handleMouseLeave=function handleMouseLeave(_ref3){var video=_ref3.currentTarget;if(hoverToPlay()){video.pause();video.currentTime=0;}};var hoverToPlay=function hoverToPlay(){return!autoPlayGif&&attachment.type==='gifv';};// FIXME: wtf?\nvar handleClick=function handleClick(e){if(isIOS()&&!e.target.autoPlay){e.target.autoPlay=true;e.preventDefault();}else{if(e.button===0&&!(e.ctrlKey||e.metaKey)){if(hoverToPlay()){e.target.pause();e.target.currentTime=0;}e.preventDefault();onClick(index);}}e.stopPropagation();};var handleVideoHover=function handleVideoHover(_ref4){var video=_ref4.currentTarget;video.playbackRate=3.0;video.play();};var handleVideoLeave=function handleVideoLeave(_ref5){var video=_ref5.currentTarget;video.pause();video.currentTime=0;};var width=100;var height='100%';var top='auto';var left='auto';var bottom='auto';var right='auto';var float='left';var position='relative';if(dimensions){width=dimensions.w;height=dimensions.h;top=dimensions.t||'auto';right=dimensions.r||'auto';bottom=dimensions.b||'auto';left=dimensions.l||'auto';float=dimensions.float||'left';position=dimensions.pos||'relative';}var thumbnail='';if(attachment.type==='unknown'){var filename=truncateFilename(attachment.url,MAX_FILENAME_LENGTH);var attachmentIcon=/*#__PURE__*/_jsx(Icon,{className:\"h-16 w-16 text-gray-800 dark:text-gray-200\",src:MIMETYPE_ICONS[attachment.getIn(['pleroma','mime_type'])]||require('@tabler/icons/paperclip.svg')});return/*#__PURE__*/_jsx(\"div\",{className:clsx('media-gallery__item',{standalone:standalone,'rounded-md':total>1}),style:{position:position,float:float,left:left,top:top,right:right,bottom:bottom,height:height,width:\"\".concat(width,\"%\")}},attachment.id,/*#__PURE__*/_jsx(\"a\",{className:\"media-gallery__item-thumbnail\",href:attachment.url,target:\"_blank\",style:{cursor:'pointer'}},void 0,/*#__PURE__*/_jsx(Blurhash,{hash:attachment.blurhash,className:\"media-gallery__preview\"}),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__item__icons\"},void 0,attachmentIcon),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__filename__label\"},void 0,filename)));}else if(attachment.type==='image'){var letterboxed=total===1&&shouldLetterbox(attachment);thumbnail=/*#__PURE__*/_jsx(\"a\",{className:\"media-gallery__item-thumbnail\",href:attachment.url,onClick:handleClick,target:\"_blank\"},void 0,/*#__PURE__*/_jsx(StillImage,{className:\"h-full w-full\",src:mediaPreview?attachment.preview_url:attachment.url,alt:attachment.description,letterboxed:letterboxed,showExt:true}));}else if(attachment.type==='gifv'){var conditionalAttributes={};if(isIOS()){conditionalAttributes.playsInline=true;}if(autoPlayGif){conditionalAttributes.autoPlay=true;}thumbnail=/*#__PURE__*/_jsx(\"div\",{className:clsx('media-gallery__gifv',{autoplay:autoPlayGif})},void 0,/*#__PURE__*/React.createElement(\"video\",_extends({className:\"media-gallery__item-gifv-thumbnail\",\"aria-label\":attachment.description,title:attachment.description,role:\"application\",src:attachment.url,onClick:handleClick,onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave,loop:true,muted:true},conditionalAttributes)),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__gifv__label\"},void 0,\"GIF\"));}else if(attachment.type==='audio'){var _attachment$url$split;var ext=(_attachment$url$split=attachment.url.split('.').pop())===null||_attachment$url$split===void 0?void 0:_attachment$url$split.toUpperCase();thumbnail=/*#__PURE__*/_jsx(\"a\",{className:clsx('media-gallery__item-thumbnail'),href:attachment.url,onClick:handleClick,target:\"_blank\",title:attachment.description},void 0,/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__item__icons\"},void 0,/*#__PURE__*/_jsx(Icon,{src:require('@tabler/icons/volume.svg')})),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__file-extension__label\"},void 0,ext));}else if(attachment.type==='video'){var _attachment$url$split2;var _ext=(_attachment$url$split2=attachment.url.split('.').pop())===null||_attachment$url$split2===void 0?void 0:_attachment$url$split2.toUpperCase();thumbnail=/*#__PURE__*/_jsx(\"a\",{className:clsx('media-gallery__item-thumbnail'),href:attachment.url,onClick:handleClick,target:\"_blank\",title:attachment.description},void 0,/*#__PURE__*/_jsx(\"video\",{muted:true,loop:true,onMouseOver:handleVideoHover,onMouseOut:handleVideoLeave},void 0,/*#__PURE__*/_jsx(\"source\",{src:attachment.url})),/*#__PURE__*/_jsx(\"span\",{className:\"media-gallery__file-extension__label\"},void 0,_ext));}return/*#__PURE__*/_jsx(\"div\",{className:clsx('media-gallery__item',\"media-gallery__item--\".concat(attachment.type),{standalone:standalone,'rounded-md':total>1}),style:{position:position,float:float,left:left,top:top,right:right,bottom:bottom,height:height,width:\"\".concat(width,\"%\")}},attachment.id,last&&total>ATTACHMENT_LIMIT&&/*#__PURE__*/_jsx(\"div\",{className:\"media-gallery__item-overflow\"},void 0,\"+\",total-ATTACHMENT_LIMIT+1),/*#__PURE__*/_jsx(Blurhash,{hash:attachment.blurhash,className:\"media-gallery__preview\"}),visible&&thumbnail);};var MediaGallery=function MediaGallery(props){var media=props.media,_props$defaultWidth=props.defaultWidth,defaultWidth=_props$defaultWidth===void 0?0:_props$defaultWidth,className=props.className,onOpenMedia=props.onOpenMedia,cacheWidth=props.cacheWidth,compact=props.compact,height=props.height;var _useState=useState(defaultWidth),_useState2=_slicedToArray(_useState,2),width=_useState2[0],setWidth=_useState2[1];var node=useRef(null);var handleClick=function handleClick(index){onOpenMedia(media,index);};var getSizeDataSingle=function getSizeDataSingle(){var w=width||defaultWidth;var aspectRatio=media.getIn([0,'meta','original','aspect']);var getHeight=function getHeight(){if(!aspectRatio)return w*9/16;if(isPanoramic(aspectRatio))return Math.floor(w/maximumAspectRatio);if(isPortrait(aspectRatio))return Math.floor(w/minimumAspectRatio);return Math.floor(w/aspectRatio);};return{style:{height:getHeight()},itemsDimensions:[],size:1,width:width};};var getSizeDataMultiple=function getSizeDataMultiple(size){var w=width||defaultWidth;var panoSize=Math.floor(w/maximumAspectRatio);var panoSize_px=\"\".concat(Math.floor(w/maximumAspectRatio),\"px\");var style={};var itemsDimensions=[];var ratios=Array(size).fill(null).map(function(_,i){return media.getIn([i,'meta','original','aspect']);});var _ratios=_slicedToArray(ratios,4),ar1=_ratios[0],ar2=_ratios[1],ar3=_ratios[2],ar4=_ratios[3];if(size===2){if(isPortrait(ar1)&&isPortrait(ar2)){style.height=w-w/maximumAspectRatio;}else if(isPanoramic(ar1)&&isPanoramic(ar2)){style.height=panoSize*2;}else if(isPanoramic(ar1)&&isPortrait(ar2)||isPortrait(ar1)&&isPanoramic(ar2)||isPanoramic(ar1)&&isNonConformingRatio(ar2)||isNonConformingRatio(ar1)&&isPanoramic(ar2)){style.height=w*0.6+w/maximumAspectRatio;}else{style.height=w/2;}if(isPortrait(ar1)&&isPortrait(ar2)){itemsDimensions=[{w:50,h:'100%',r:'2px'},{w:50,h:'100%',l:'2px'}];}else if(isPanoramic(ar1)&&isPanoramic(ar2)){itemsDimensions=[{w:100,h:panoSize_px,b:'2px'},{w:100,h:panoSize_px,t:'2px'}];}else if(isPanoramic(ar1)&&isPortrait(ar2)||isPanoramic(ar1)&&isNonConformingRatio(ar2)){itemsDimensions=[{w:100,h:\"\".concat(w/maximumAspectRatio,\"px\"),b:'2px'},{w:100,h:\"\".concat(w*0.6,\"px\"),t:'2px'}];}else if(isPortrait(ar1)&&isPanoramic(ar2)||isNonConformingRatio(ar1)&&isPanoramic(ar2)){itemsDimensions=[{w:100,h:\"\".concat(w*0.6,\"px\"),b:'2px'},{w:100,h:\"\".concat(w/maximumAspectRatio,\"px\"),t:'2px'}];}else{itemsDimensions=[{w:50,h:'100%',r:'2px'},{w:50,h:'100%',l:'2px'}];}}else if(size===3){if(isPanoramic(ar1)&&isPanoramic(ar2)&&isPanoramic(ar3)){style.height=panoSize*3;}else if(isPortrait(ar1)&&isPortrait(ar2)&&isPortrait(ar3)){style.height=Math.floor(w/minimumAspectRatio);}else{style.height=w;}if(isPanoramic(ar1)&&isNonConformingRatio(ar2)&&isNonConformingRatio(ar3)){itemsDimensions=[{w:100,h:'50%',b:'2px'},{w:50,h:'50%',t:'2px',r:'2px'},{w:50,h:'50%',t:'2px',l:'2px'}];}else if(isPanoramic(ar1)&&isPanoramic(ar2)&&isPanoramic(ar3)){itemsDimensions=[{w:100,h:panoSize_px,b:'4px'},{w:100,h:panoSize_px},{w:100,h:panoSize_px,t:'4px'}];}else if(isPortrait(ar1)&&isNonConformingRatio(ar2)&&isNonConformingRatio(ar3)){itemsDimensions=[{w:50,h:'100%',r:'2px'},{w:50,h:'50%',b:'2px',l:'2px'},{w:50,h:'50%',t:'2px',l:'2px'}];}else if(isNonConformingRatio(ar1)&&isNonConformingRatio(ar2)&&isPortrait(ar3)){itemsDimensions=[{w:50,h:'50%',b:'2px',r:'2px'},{w:50,h:'50%',l:'-2px',b:'-2px',pos:'absolute',float:'none'},{w:50,h:'100%',r:'-2px',t:'0px',b:'0px',pos:'absolute',float:'none'}];}else if(isNonConformingRatio(ar1)&&isPortrait(ar2)&&isNonConformingRatio(ar3)||isPortrait(ar1)&&isPortrait(ar2)&&isPortrait(ar3)){itemsDimensions=[{w:50,h:'50%',b:'2px',r:'2px'},{w:50,h:'100%',l:'2px',float:'right'},{w:50,h:'50%',t:'2px',r:'2px'}];}else if(isPanoramic(ar1)&&isPanoramic(ar2)&&isNonConformingRatio(ar3)||isPanoramic(ar1)&&isPanoramic(ar2)&&isPortrait(ar3)){itemsDimensions=[{w:50,h:panoSize_px,b:'2px',r:'2px'},{w:50,h:panoSize_px,b:'2px',l:'2px'},{w:100,h:\"\".concat(w-panoSize,\"px\"),t:'2px'}];}else if(isNonConformingRatio(ar1)&&isPanoramic(ar2)&&isPanoramic(ar3)||isPortrait(ar1)&&isPanoramic(ar2)&&isPanoramic(ar3)){itemsDimensions=[{w:100,h:\"\".concat(w-panoSize,\"px\"),b:'2px'},{w:50,h:panoSize_px,t:'2px',r:'2px'},{w:50,h:panoSize_px,t:'2px',l:'2px'}];}else{itemsDimensions=[{w:50,h:'50%',b:'2px',r:'2px'},{w:50,h:'50%',b:'2px',l:'2px'},{w:100,h:'50%',t:'2px'}];}}else if(size>=4){if(isPortrait(ar1)&&isPortrait(ar2)&&isPortrait(ar3)&&isPortrait(ar4)||isPortrait(ar1)&&isPortrait(ar2)&&isPortrait(ar3)&&isNonConformingRatio(ar4)||isPortrait(ar1)&&isPortrait(ar2)&&isNonConformingRatio(ar3)&&isPortrait(ar4)||isPortrait(ar1)&&isNonConformingRatio(ar2)&&isPortrait(ar3)&&isPortrait(ar4)||isNonConformingRatio(ar1)&&isPortrait(ar2)&&isPortrait(ar3)&&isPortrait(ar4)){style.height=Math.floor(w/minimumAspectRatio);}else if(isPanoramic(ar1)&&isPanoramic(ar2)&&isPanoramic(ar3)&&isPanoramic(ar4)){style.height=panoSize*2;}else if(isPanoramic(ar1)&&isPanoramic(ar2)&&isNonConformingRatio(ar3)&&isNonConformingRatio(ar4)||isNonConformingRatio(ar1)&&isNonConformingRatio(ar2)&&isPanoramic(ar3)&&isPanoramic(ar4)){style.height=panoSize+w/2;}else{style.height=w;}if(isPanoramic(ar1)&&isPanoramic(ar2)&&isNonConformingRatio(ar3)&&isNonConformingRatio(ar4)){itemsDimensions=[{w:50,h:panoSize_px,b:'2px',r:'2px'},{w:50,h:panoSize_px,b:'2px',l:'2px'},{w:50,h:\"\".concat(w/2,\"px\"),t:'2px',r:'2px'},{w:50,h:\"\".concat(w/2,\"px\"),t:'2px',l:'2px'}];}else if(isNonConformingRatio(ar1)&&isNonConformingRatio(ar2)&&isPanoramic(ar3)&&isPanoramic(ar4)){itemsDimensions=[{w:50,h:\"\".concat(w/2,\"px\"),b:'2px',r:'2px'},{w:50,h:\"\".concat(w/2,\"px\"),b:'2px',l:'2px'},{w:50,h:panoSize_px,t:'2px',r:'2px'},{w:50,h:panoSize_px,t:'2px',l:'2px'}];}else if(isPortrait(ar1)&&isNonConformingRatio(ar2)&&isNonConformingRatio(ar3)&&isNonConformingRatio(ar4)||isPortrait(ar1)&&isPanoramic(ar2)&&isPanoramic(ar3)&&isPanoramic(ar4)){itemsDimensions=[{w:67,h:'100%',r:'2px'},{w:33,h:'33%',b:'4px',l:'2px'},{w:33,h:'33%',l:'2px'},{w:33,h:'33%',t:'4px',l:'2px'}];}else{itemsDimensions=[{w:50,h:'50%',b:'2px',r:'2px'},{w:50,h:'50%',b:'2px',l:'2px'},{w:50,h:'50%',t:'2px',r:'2px'},{w:50,h:'50%',t:'2px',l:'2px'}];}}return{style:style,itemsDimensions:itemsDimensions,size:size,width:w};};var getSizeData=function getSizeData(size){var w=width||defaultWidth;if(w){if(size===1)return getSizeDataSingle();if(size>1)return getSizeDataMultiple(size);}return{style:{height:height},itemsDimensions:[],size:size,width:w};};var sizeData=getSizeData(media.size);var children=media.take(ATTACHMENT_LIMIT).map(function(attachment,i){return/*#__PURE__*/_jsx(Item,{onClick:handleClick,attachment:attachment,index:i,size:sizeData.size,displayWidth:sizeData.width,visible:!!props.visible,dimensions:sizeData.itemsDimensions[i],last:i===ATTACHMENT_LIMIT-1,total:media.size},attachment.id);});useLayoutEffect(function(){if(node.current){var offsetWidth=node.current.offsetWidth;if(cacheWidth){cacheWidth(offsetWidth);}setWidth(offsetWidth);}},[node.current]);return/*#__PURE__*/React.createElement(\"div\",{className:clsx(className,'media-gallery',{'media-gallery--compact':compact}),style:sizeData.style,ref:node},children);};export default MediaGallery;"],"names":["Item","_ref","attachment","index","onClick","_ref$standalone","standalone","visible","dimensions","last","total","autoPlayGif","get","mediaPreview","hoverToPlay","type","handleClick","e","target","autoPlay","preventDefault","button","ctrlKey","metaKey","pause","currentTime","stopPropagation","width","height","top","left","bottom","right","float","position","w","h","t","r","b","l","pos","thumbnail","filename","url","attachmentIcon","className","src","getIn","style","concat","id","href","cursor","hash","blurhash","letterboxed","aspectRatio","withinLimits","shouldLetterbox","preview_url","alt","description","showExt","conditionalAttributes","playsInline","autoplay","title","role","onMouseEnter","_ref2","video","currentTarget","play","onMouseLeave","_ref3","loop","muted","_attachment$url$split","ext","split","pop","toUpperCase","_attachment$url$split2","_ext","onMouseOver","_ref4","playbackRate","onMouseOut","_ref5","props","media","_props$defaultWidth","defaultWidth","onOpenMedia","cacheWidth","compact","_useState","useState","_useState2","setWidth","node","useRef","sizeData","size","Math","floor","itemsDimensions","getSizeDataSingle","panoSize","panoSize_px","ratios","Array","fill","map","_","i","_ratios","ar1","ar2","ar3","ar4","getSizeDataMultiple","getSizeData","children","take","displayWidth","ATTACHMENT_LIMIT","useLayoutEffect","current","offsetWidth","ref"],"sourceRoot":""}